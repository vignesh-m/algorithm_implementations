<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=cGvuclDC_Z1vE_cnVEU6AcEmLsaRfUCEWXtSE4T9Az9N_rIRgpcuba1Qp4FSu3QR');.lst-kix_55fxpao5xuz6-7>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-5>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-4>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-8>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-6>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-0>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-5>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-0>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-2>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-1>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-6>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-1>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-3>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-7>li:before{content:"-  "}.lst-kix_55fxpao5xuz6-2>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-8>li:before{content:"-  "}ul.lst-kix_55fxpao5xuz6-0{list-style-type:none}ul.lst-kix_55fxpao5xuz6-2{list-style-type:none}ul.lst-kix_55fxpao5xuz6-1{list-style-type:none}ul.lst-kix_55fxpao5xuz6-4{list-style-type:none}ul.lst-kix_55fxpao5xuz6-3{list-style-type:none}ul.lst-kix_55fxpao5xuz6-6{list-style-type:none}ul.lst-kix_55fxpao5xuz6-5{list-style-type:none}ul.lst-kix_55fxpao5xuz6-8{list-style-type:none}ul.lst-kix_55fxpao5xuz6-7{list-style-type:none}ul.lst-kix_yjonuqu38wrd-8{list-style-type:none}ul.lst-kix_yjonuqu38wrd-7{list-style-type:none}ul.lst-kix_yjonuqu38wrd-6{list-style-type:none}.lst-kix_sk0thmln02um-6>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-8>li:before{content:"-  "}.lst-kix_sk0thmln02um-5>li:before{content:"-  "}.lst-kix_sk0thmln02um-7>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-7>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-6>li:before{content:"-  "}.lst-kix_sk0thmln02um-2>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-4>li:before{content:"-  "}.lst-kix_sk0thmln02um-1>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-3>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-5>li:before{content:"-  "}ul.lst-kix_fzlazu9c41rt-8{list-style-type:none}.lst-kix_sk0thmln02um-0>li:before{content:"-  "}.lst-kix_sk0thmln02um-8>li:before{content:"-  "}ul.lst-kix_fzlazu9c41rt-7{list-style-type:none}ul.lst-kix_fzlazu9c41rt-6{list-style-type:none}ul.lst-kix_fzlazu9c41rt-5{list-style-type:none}ul.lst-kix_fzlazu9c41rt-4{list-style-type:none}ul.lst-kix_fzlazu9c41rt-3{list-style-type:none}ul.lst-kix_fzlazu9c41rt-2{list-style-type:none}ul.lst-kix_fzlazu9c41rt-1{list-style-type:none}ul.lst-kix_fzlazu9c41rt-0{list-style-type:none}.lst-kix_6wll5q2ze1mf-5>li:before{content:"-  "}.lst-kix_sk0thmln02um-3>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-4>li:before{content:"-  "}.lst-kix_sk0thmln02um-4>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-3>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-6>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-7>li:before{content:"-  "}.lst-kix_6wll5q2ze1mf-8>li:before{content:"-  "}.lst-kix_yjonuqu38wrd-2>li:before{content:"-  "}ul.lst-kix_jvuqxjbg1gbx-3{list-style-type:none}ul.lst-kix_jvuqxjbg1gbx-2{list-style-type:none}ul.lst-kix_jvuqxjbg1gbx-5{list-style-type:none}ul.lst-kix_jvuqxjbg1gbx-4{list-style-type:none}ul.lst-kix_sk0thmln02um-3{list-style-type:none}ul.lst-kix_sk0thmln02um-2{list-style-type:none}ul.lst-kix_sk0thmln02um-1{list-style-type:none}.lst-kix_yjonuqu38wrd-1>li:before{content:"-  "}.lst-kix_yjonuqu38wrd-5>li:before{content:"-  "}ul.lst-kix_jvuqxjbg1gbx-1{list-style-type:none}ul.lst-kix_sk0thmln02um-0{list-style-type:none}ul.lst-kix_jvuqxjbg1gbx-0{list-style-type:none}.lst-kix_yjonuqu38wrd-6>li:before{content:"-  "}.lst-kix_yjonuqu38wrd-0>li:before{content:"-  "}.lst-kix_yjonuqu38wrd-8>li:before{content:"-  "}.lst-kix_yjonuqu38wrd-7>li:before{content:"-  "}.lst-kix_yjonuqu38wrd-4>li:before{content:"-  "}ul.lst-kix_jvuqxjbg1gbx-7{list-style-type:none}ul.lst-kix_jvuqxjbg1gbx-6{list-style-type:none}.lst-kix_yjonuqu38wrd-3>li:before{content:"-  "}ul.lst-kix_jvuqxjbg1gbx-8{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-8{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-7{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-6{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-5{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-4{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-3{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-2{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-1{list-style-type:none}ul.lst-kix_p6zo5vs9euaf-0{list-style-type:none}.lst-kix_fzlazu9c41rt-3>li:before{content:"-  "}.lst-kix_fzlazu9c41rt-4>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-0>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-1>li:before{content:"-  "}.lst-kix_fzlazu9c41rt-5>li:before{content:"-  "}.lst-kix_fzlazu9c41rt-7>li:before{content:"-  "}.lst-kix_p6zo5vs9euaf-2>li:before{content:"-  "}.lst-kix_fzlazu9c41rt-6>li:before{content:"-  "}ul.lst-kix_sk0thmln02um-7{list-style-type:none}ul.lst-kix_sk0thmln02um-6{list-style-type:none}ul.lst-kix_sk0thmln02um-5{list-style-type:none}ul.lst-kix_sk0thmln02um-4{list-style-type:none}ul.lst-kix_sk0thmln02um-8{list-style-type:none}.lst-kix_fzlazu9c41rt-8>li:before{content:"-  "}ul.lst-kix_yjonuqu38wrd-5{list-style-type:none}ul.lst-kix_yjonuqu38wrd-4{list-style-type:none}ul.lst-kix_yjonuqu38wrd-3{list-style-type:none}ul.lst-kix_yjonuqu38wrd-2{list-style-type:none}ul.lst-kix_yjonuqu38wrd-1{list-style-type:none}ul.lst-kix_yjonuqu38wrd-0{list-style-type:none}.lst-kix_fzlazu9c41rt-2>li:before{content:"-  "}.lst-kix_fzlazu9c41rt-1>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-4>li:before{content:"-  "}.lst-kix_fzlazu9c41rt-0>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-3>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-2>li:before{content:"-  "}ul.lst-kix_6wll5q2ze1mf-8{list-style-type:none}ul.lst-kix_6wll5q2ze1mf-7{list-style-type:none}.lst-kix_jvuqxjbg1gbx-1>li:before{content:"-  "}.lst-kix_jvuqxjbg1gbx-0>li:before{content:"-  "}ul.lst-kix_6wll5q2ze1mf-0{list-style-type:none}ul.lst-kix_6wll5q2ze1mf-2{list-style-type:none}ul.lst-kix_6wll5q2ze1mf-1{list-style-type:none}ul.lst-kix_6wll5q2ze1mf-4{list-style-type:none}ul.lst-kix_6wll5q2ze1mf-3{list-style-type:none}ul.lst-kix_6wll5q2ze1mf-6{list-style-type:none}ul.lst-kix_6wll5q2ze1mf-5{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c0{background-color:#ffffff;font-size:8pt;font-family:"Consolas";color:#666600}.c1{font-size:8pt;font-family:"Consolas";color:#666600}.c7{font-size:9pt;font-family:"Consolas";color:#666600}.c2{font-size:8pt;font-family:"Consolas";color:#000000}.c5{font-size:9pt;font-family:"Consolas";color:#000000}.c6{font-size:8pt;font-family:"Consolas";color:#880000}.c14{text-align:right;height:11pt}.c4{orphans:2;widows:2}.c10{margin-left:36pt;padding-left:0pt}.c13{font-size:9pt;font-family:"Consolas"}.c33{background-color:#f0f0f0;color:#66cc66}.c16{padding:0;margin:0}.c30{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c8{font-size:8pt;font-family:"Consolas"}.c20{font-size:8.5pt;font-family:"Consolas"}.c26{page-break-after:avoid;height:16pt}.c15{font-style:italic}.c32{font-family:"Ubuntu Mono"}.c19{color:#008800}.c27{color:#800080}.c24{text-align:center}.c17{height:11pt}.c34{text-align:left}.c22{color:#660066}.c18{font-size:24pt}.c21{font-size:8.5pt}.c12{color:#006666}.c11{font-weight:700}.c3{background-color:#ffffff}.c31{font-size:18pt}.c29{page-break-after:avoid}.c25{font-family:"Consolas"}.c9{color:#000088}.c23{color:#880000}.c28{text-align:right}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 c30"><div><p class="c4"><span class="c13">Team: </span><span class="c13 c11">Overflow</span></p><p class="c4 c14"><span class="c13 c11"></span></p></div><p class="c4 c17"><span></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24"><span class="c18">Team Overflow</span></p><p class="c4 c24 c17"><span class="c31"></span></p><hr style="page-break-before:always;display:none;"><p class="c4 c24 c17"><span></span></p><p class="c4"><span>Data Structures</span></p><ul class="c16 lst-kix_sk0thmln02um-0 start"><li class="c4 c10"><span>Fenwick tree (BIT): 1</span></li><li class="c4 c10"><span>Segment tree: 1</span></li><li class="c4 c10"><span>Binary trie: 2</span></li><li class="c4 c10"><span>DSU: 3</span></li></ul><p class="c4 c17"><span></span></p><p class="c4"><span>Graph Algorithms</span></p><ul class="c16 lst-kix_jvuqxjbg1gbx-0 start"><li class="c4 c10"><span>Bellman Ford: 3</span></li><li class="c4 c10"><span>Dijkstra&rsquo;s: 3</span></li><li class="c4 c10"><span>Floyd Warshall: 4</span></li><li class="c4 c10"><span>Cut-edges and cut-vertices: 4</span></li><li class="c4 c10"><span>Strongly connected components: 5</span></li><li class="c4 c10"><span>Dinic&rsquo;s algorithm: 6</span></li><li class="c4 c10"><span>LCA: 8</span></li></ul><p class="c4 c17"><span></span></p><p class="c4"><span>Ad-hoc</span></p><ul class="c16 lst-kix_yjonuqu38wrd-0 start"><li class="c4 c10"><span>Josephus problem: 9</span></li><li class="c4 c10"><span>Binary search over reals, over ints: 9</span></li><li class="c4 c10"><span>Extended Euclid&rsquo;s algo: 10</span></li><li class="c4 c10"><span>Fibonacci: 10</span></li><li class="c4 c10"><span>Factorial divider: 10</span></li><li class="c4 c10"><span>Gauss&rsquo; theorem: 10</span></li></ul><p class="c4 c17"><span></span></p><p class="c4"><span>Geometry</span></p><ul class="c16 lst-kix_6wll5q2ze1mf-0 start"><li class="c4 c10"><span>Convex hull: 11</span></li></ul><p class="c4 c17"><span></span></p><p class="c4"><span>Strings</span></p><ul class="c16 lst-kix_55fxpao5xuz6-0 start"><li class="c4 c10"><span>Rabin-Karp: 12</span></li><li class="c4 c10"><span>Manacher&rsquo;s algorithm: 12</span></li><li class="c4 c10"><span>Suffix Array: 13</span></li></ul><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><h2 class="c4 c29" id="h.9lpmorkt9gnc"><span class="c11">Data Structures</span></h2><p class="c4"><span class="c11">Binary Indexed Tree (Fenwick tree)</span></p><p class="c4"><span>query(idx) gives sum of values from 0 to idx</span></p><p class="c4"><span>update(idx,val) increases value at idx by val</span></p><p class="c4"><span class="c13 c9">const</span><span class="c5">&nbsp;</span><span class="c13 c9">int</span><span class="c5">&nbsp;N </span><span class="c7">=</span><span class="c5">&nbsp;</span><span class="c13 c12">100000;</span></p><p class="c4"><span class="c13 c9">int</span><span class="c5">&nbsp;bit</span><span class="c7">[</span><span class="c5">N</span><span class="c7">];</span></p><p class="c4"><span class="c13 c9">void</span><span class="c5">&nbsp;update</span><span class="c7">(</span><span class="c13 c9">int</span><span class="c5">&nbsp;idx</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;val</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">while</span><span class="c7">(</span><span class="c5">idx</span><span class="c7">&lt;=</span><span class="c5">N</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; bit</span><span class="c7">[</span><span class="c5">idx</span><span class="c7">]+=</span><span class="c5">val;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; idx</span><span class="c7">+=(</span><span class="c5">idx </span><span class="c7">&amp;</span><span class="c5">&nbsp;</span><span class="c7">-</span><span class="c5">idx</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">}</span></p><p class="c4"><span class="c9 c13">int</span><span class="c5">&nbsp;query</span><span class="c7">(</span><span class="c13 c9">int</span><span class="c5">&nbsp;idx</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">int</span><span class="c5">&nbsp;sum</span><span class="c7">=</span><span class="c13 c12">0;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">while</span><span class="c7">(</span><span class="c5">idx</span><span class="c7">&gt;</span><span class="c13 c12">0</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; sum</span><span class="c7">+=</span><span class="c5">bit</span><span class="c7">[</span><span class="c5">idx</span><span class="c7">];</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; idx</span><span class="c7">-=(</span><span class="c5">idx </span><span class="c7">&amp;</span><span class="c5">&nbsp;</span><span class="c7">-</span><span class="c5">idx</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;sum;</span></p><p class="c4"><span class="c5">}</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Segment tree</span></p><p class="c4"><span class="c13 c9">const</span><span class="c5">&nbsp;</span><span class="c13 c9">int</span><span class="c5">&nbsp;maxn</span><span class="c7">=</span><span class="c13 c12">100010;</span></p><p class="c4"><span class="c5">ll a</span><span class="c7">[</span><span class="c5">maxn</span><span class="c7">],</span><span class="c5">tree</span><span class="c7">[</span><span class="c13 c12">4</span><span class="c7">*</span><span class="c5">maxn</span><span class="c7">];</span></p><p class="c4"><span class="c5">ll merge</span><span class="c7">(</span><span class="c5">ll t1</span><span class="c7">,</span><span class="c5">ll t2</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;min</span><span class="c7">(</span><span class="c5">t1</span><span class="c7">,</span><span class="c5">t2</span><span class="c7">);</span></p><p class="c4"><span class="c5">}</span></p><p class="c4"><span class="c13 c9">void</span><span class="c5">&nbsp;build</span><span class="c7">(</span><span class="c13 c9">int</span><span class="c5">&nbsp;v</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;l</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;r</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// call v=1,l=0,r=n-1</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">l</span><span class="c7">==</span><span class="c5">r</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; tree</span><span class="c7">[</span><span class="c5">v</span><span class="c7">]=</span><span class="c5">a</span><span class="c7">[</span><span class="c5">l</span><span class="c7">];</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c7">}</span><span class="c5">&nbsp;</span><span class="c13 c9">else</span><span class="c5">&nbsp;{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">int</span><span class="c5">&nbsp;mid</span><span class="c7">=(</span><span class="c5">l</span><span class="c7">+</span><span class="c5">r</span><span class="c7">)/</span><span class="c13 c12">2;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; build</span><span class="c7">(</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">,</span><span class="c5">l</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; build</span><span class="c7">(</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">r</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; tree</span><span class="c7">[</span><span class="c5">v</span><span class="c7">]=</span><span class="c5">merge</span><span class="c7">(</span><span class="c5">tree</span><span class="c7">[</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">],</span><span class="c5">tree</span><span class="c7">[</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">]);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">}</span></p><p class="c4"><span class="c5">ll query</span><span class="c7">(</span><span class="c13 c9">int</span><span class="c5">&nbsp;v</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;l</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;r</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;ql</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;qr</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// call v=1,l=0,r=n-1 to query from ql to qr(included)</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">ql</span><span class="c7">&gt;</span><span class="c5">qr)</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;</span><span class="c7">(</span><span class="c13 c12">1ll</span><span class="c7">&lt;&lt;</span><span class="c13 c12">31</span><span class="c7">)-</span><span class="c13 c12">1</span><span class="c7">;</span><span class="c5">&nbsp;</span><span class="c13 c23">// check this for &#39;identity&#39; value</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">l</span><span class="c7">==</span><span class="c5">ql </span><span class="c7">&amp;&amp;</span><span class="c5">&nbsp;r</span><span class="c7">==</span><span class="c5">qr)</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;tree</span><span class="c7">[</span><span class="c5">v</span><span class="c7">];</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">int</span><span class="c5">&nbsp;mid</span><span class="c7">=(</span><span class="c5">l</span><span class="c7">+</span><span class="c5">r</span><span class="c7">)/</span><span class="c13 c12">2;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;merge</span><span class="c7">(</span><span class="c5">query</span><span class="c7">(</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">,</span><span class="c5">l</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">,</span><span class="c5">ql</span><span class="c7">,</span><span class="c5">min</span><span class="c7">(</span><span class="c5">qr</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">)),</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;query</span><span class="c7">(</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">r</span><span class="c7">,</span><span class="c5">max</span><span class="c7">(</span><span class="c5">ql</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">),</span><span class="c5">qr</span><span class="c7">));</span></p><p class="c4"><span class="c5">}</span></p><p class="c4"><span class="c13 c9">void</span><span class="c5">&nbsp;update</span><span class="c7">(</span><span class="c13 c9">int</span><span class="c5">&nbsp;v</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;l</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;r</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;idx</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;val</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// call v=1,l=0,r=n-1 to update idx to val</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">l</span><span class="c7">==</span><span class="c5">r</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c23">// may want to update a</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; tree</span><span class="c7">[</span><span class="c5">v</span><span class="c7">]=</span><span class="c5">val</span><span class="c7">;</span><span class="c5">&nbsp; </span><span class="c13 c23">// update properly</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c7">}</span><span class="c5">&nbsp;</span><span class="c13 c9">else</span><span class="c5">&nbsp;{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">int</span><span class="c5">&nbsp;mid</span><span class="c7">=(</span><span class="c5">l</span><span class="c7">+</span><span class="c5">r</span><span class="c7">)/</span><span class="c13 c12">2;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">idx</span><span class="c7">&lt;=</span><span class="c5">mid</span><span class="c7">)</span><span class="c5">&nbsp;update</span><span class="c7">(</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">,</span><span class="c5">l</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">,</span><span class="c5">idx</span><span class="c7">,</span><span class="c5">val</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">else</span><span class="c5">&nbsp;update</span><span class="c7">(</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">mid</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">r</span><span class="c7">,</span><span class="c5">idx</span><span class="c7">,</span><span class="c5">val</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; tree</span><span class="c7">[</span><span class="c5">v</span><span class="c7">]=</span><span class="c5">merge</span><span class="c7">(</span><span class="c5">tree</span><span class="c7">[</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">],</span><span class="c5">tree</span><span class="c7">[</span><span class="c13 c12">2</span><span class="c7">*</span><span class="c5">v</span><span class="c7">+</span><span class="c13 c12">1</span><span class="c7">]);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">}</span></p><p class="c4 c17"><span class="c21"></span></p><p class="c4"><span class="c11">Binary trie - for xor queries</span></p><p class="c4"><span class="c13 c9">struct</span><span class="c5">&nbsp;trie{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// binary</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">int</span><span class="c5">&nbsp;n0</span><span class="c7">,</span><span class="c5">n1;</span></p><p class="c4"><span class="c7">};</span></p><p class="c4"><span class="c13 c9">const</span><span class="c5">&nbsp;</span><span class="c13 c9">int</span><span class="c5">&nbsp;MAXN</span><span class="c7">=</span><span class="c13 c12">100;</span></p><p class="c4"><span class="c5">trie arr</span><span class="c7">[</span><span class="c5">MAXN</span><span class="c7">*</span><span class="c13 c12">32</span><span class="c7">];</span><span class="c5">&nbsp;</span><span class="c13 c23">// max depth 32</span></p><p class="c4"><span class="c13 c9">int</span><span class="c5">&nbsp;cnt</span><span class="c7">=</span><span class="c13 c12">0;</span></p><p class="c4"><span class="c13 c9">int</span><span class="c5">&nbsp;new_node</span><span class="c7">(){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; cnt</span><span class="c7">++;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; arr</span><span class="c7">[</span><span class="c5">cnt</span><span class="c7">]={-</span><span class="c13 c12">1</span><span class="c7">,-</span><span class="c13 c12">1</span><span class="c7">};</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;cnt;</span></p><p class="c4"><span class="c5">}</span></p><p class="c4"><span class="c13 c9">int</span><span class="c5">&nbsp;insert</span><span class="c7">(</span><span class="c13 c9">int</span><span class="c5">&nbsp;t</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;v</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;l</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// insert l bits of v in tree[t]</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// call insert(root,val,max depth)</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">t</span><span class="c7">&lt;</span><span class="c13 c12">0</span><span class="c7">)</span><span class="c5">&nbsp;t</span><span class="c7">=</span><span class="c5">new_node</span><span class="c7">();</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">l</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">v</span><span class="c7">&amp;</span><span class="c13 c12">1</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n1</span><span class="c7">=</span><span class="c5">insert</span><span class="c7">(</span><span class="c5">arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n1</span><span class="c7">,</span><span class="c5">v</span><span class="c7">&gt;&gt;</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">l</span><span class="c7">-</span><span class="c13 c12">1</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c7">}</span><span class="c5">&nbsp;</span><span class="c13 c9">else</span><span class="c5">&nbsp;{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n0</span><span class="c7">=</span><span class="c5">insert</span><span class="c7">(</span><span class="c5">arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n0</span><span class="c7">,</span><span class="c5">v</span><span class="c7">&gt;&gt;</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">l</span><span class="c7">-</span><span class="c13 c12">1</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;t;</span></p><p class="c4"><span class="c5">}</span></p><p class="c4"><span class="c13 c9">int</span><span class="c5">&nbsp;query</span><span class="c7">(</span><span class="c13 c9">int</span><span class="c5">&nbsp;t</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;v</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;l</span><span class="c7">,</span><span class="c13 c9">int</span><span class="c5">&nbsp;prev</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// query t for value most different from v</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// gives number in trie with largest value on xor with v</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c23">// call query(root,val,max depth,0)</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">l</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">int</span><span class="c5">&nbsp;</span><span class="c13 c9">next</span><span class="c7">=-</span><span class="c13 c12">1;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">v</span><span class="c7">&amp;</span><span class="c13 c12">1</span><span class="c7">)</span><span class="c5">&nbsp;</span><span class="c13 c9">next</span><span class="c7">=</span><span class="c5">arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n0;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">else</span><span class="c5">&nbsp;</span><span class="c13 c9">next</span><span class="c7">=</span><span class="c5">arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n1;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c13 c9">next</span><span class="c7">&gt;</span><span class="c13 c12">0</span><span class="c7">){</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;query</span><span class="c7">(</span><span class="c13 c9">next</span><span class="c7">,</span><span class="c5">v</span><span class="c7">&gt;&gt;</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">l</span><span class="c7">-</span><span class="c13 c12">1</span><span class="c7">,(</span><span class="c5">prev</span><span class="c7">&lt;&lt;</span><span class="c13 c12">1</span><span class="c7">)</span><span class="c5">&nbsp;</span><span class="c7">+</span><span class="c5">&nbsp;</span><span class="c13 c12">1</span><span class="c7">);</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c7">}</span><span class="c5">&nbsp;</span><span class="c13 c9">else</span><span class="c5">&nbsp;{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c23">// try other subtree</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">if</span><span class="c7">(</span><span class="c5">v</span><span class="c7">&amp;</span><span class="c13 c12">1</span><span class="c7">)</span><span class="c5">&nbsp;</span><span class="c13 c9">next</span><span class="c7">=</span><span class="c5">arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n1;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">else</span><span class="c5">&nbsp;</span><span class="c13 c9">next</span><span class="c7">=</span><span class="c5">arr</span><span class="c7">[</span><span class="c5">t</span><span class="c7">].</span><span class="c5">n0;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;query</span><span class="c7">(</span><span class="c13 c9">next</span><span class="c7">,</span><span class="c5">v</span><span class="c7">&gt;&gt;</span><span class="c13 c12">1</span><span class="c7">,</span><span class="c5">l</span><span class="c7">-</span><span class="c13 c12">1</span><span class="c7">,(</span><span class="c5">prev</span><span class="c7">&lt;&lt;</span><span class="c13 c12">1</span><span class="c7">));</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; </span><span class="c7">}</span><span class="c5">&nbsp;</span><span class="c13 c9">else</span><span class="c5">&nbsp;{</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c13 c9">return</span><span class="c5">&nbsp;prev;</span></p><p class="c4"><span class="c5">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c5">}</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Disjoint set union</span></p><p class="c4"><span class="c8 c3 c9">const</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;MAXN</span><span class="c0">=</span><span class="c8 c12 c3">100000;</span></p><p class="c4"><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;par</span><span class="c0">[</span><span class="c2 c3">MAXN</span><span class="c0">]; </span></p><p class="c4"><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;init</span><span class="c0">()</span><span class="c2 c3">&nbsp;{</span></p><p class="c4"><span class="c2 c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">MAXN</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">++)</span></p><p class="c4"><span class="c2 c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]=-</span><span class="c8 c12 c3">1;</span></p><p class="c4"><span class="c2 c3">}</span></p><p class="c4"><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;root</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;v</span><span class="c0">){</span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;par</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c2 c3">&nbsp;</span><span class="c0">?</span><span class="c2 c3">&nbsp;v </span><span class="c0">:</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">par</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;root</span><span class="c0">(</span><span class="c2 c3">par</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]));}</span></p><p class="c4"><span class="c6 c3">// x,y in same group iff root(x)==root(y)</span><span class="c2 c3"><br></span><span class="c8 c3 c9">void</span><span class="c2 c3">&nbsp;merge</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;x</span><span class="c0">,</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;y</span><span class="c0">){</span><span class="c2 c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6 c3">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x and y are some vertices</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8 c3 c9">if</span><span class="c0">((</span><span class="c2 c3">x </span><span class="c0">=</span><span class="c2 c3">&nbsp;root</span><span class="c0">(</span><span class="c2 c3">x</span><span class="c0">))</span><span class="c2 c3">&nbsp;</span><span class="c0">==</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">y </span><span class="c0">=</span><span class="c2 c3">&nbsp;root</span><span class="c0">(</span><span class="c2 c3">y</span><span class="c0">))</span><span class="c2 c3">&nbsp; &nbsp; &nbsp;</span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">par</span><span class="c0">[</span><span class="c2 c3">y</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;par</span><span class="c0">[</span><span class="c2 c3">x</span><span class="c0">])</span><span class="c2 c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6 c3">// balancing the height of the tree</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap</span><span class="c0">(</span><span class="c2 c3">x</span><span class="c0">,</span><span class="c2 c3">&nbsp;y</span><span class="c0">);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par</span><span class="c0">[</span><span class="c2 c3">x</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">+=</span><span class="c2 c3">&nbsp;par</span><span class="c0">[</span><span class="c2 c3">y</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par</span><span class="c0">[</span><span class="c2 c3">y</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;x</span><span class="c0">;</span><span class="c2 c3"><br>}</span></p><h2 class="c4 c29" id="h.hhna0rfxsk7"><span class="c11">Graph Algorithms</span></h2><p class="c4"><span class="c11">Bellman-Ford: shortest path problems with negative edges (no negative cycles) O(VE)</span></p><p class="c4"><span class="c8 c3 c9">void</span><span class="c2 c3">&nbsp;bellmanford</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;s</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; dist</span><span class="c0">[</span><span class="c2 c3">s</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;n</span><span class="c0">=(</span><span class="c8 c3 c9">int</span><span class="c0">)</span><span class="c2 c3">graph</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">();</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">&lt;</span><span class="c2 c3">n</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">++){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;u</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">u</span><span class="c0">&lt;</span><span class="c2 c3">n</span><span class="c0">;</span><span class="c2 c3">u</span><span class="c0">++){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c2 c3">ii v</span><span class="c0">:</span><span class="c2 c3">graph</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dist</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">.</span><span class="c2 c3">first</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;min</span><span class="c0">(</span><span class="c2 c3">dist</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">.</span><span class="c2 c3">first</span><span class="c0">],</span><span class="c2 c3">&nbsp;dist</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;v</span><span class="c0">.</span><span class="c2 c3">second</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">}</span></p><p class="c4"><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;check_neg_cycle</span><span class="c0">(){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c6 c3">// call bellmanford first</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;n</span><span class="c0">=(</span><span class="c8 c3 c9">int</span><span class="c0">)</span><span class="c2 c3">graph</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">();</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;u</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">u</span><span class="c0">&lt;</span><span class="c2 c3">n</span><span class="c0">;</span><span class="c2 c3">u</span><span class="c0">++){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c2 c3">ii v</span><span class="c0">:</span><span class="c2 c3">graph</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">dist</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">.</span><span class="c2 c3">first</span><span class="c0">]&gt;</span><span class="c2 c3">dist</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;v</span><span class="c0">.</span><span class="c2 c3">second)</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">true;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">false;</span></p><p class="c4"><span class="c2 c3">}</span></p><p class="c4 c17"><span class="c8 c22 c3"></span></p><p class="c4"><span class="c11">Dijkstra - shortest path from single source O((V+E)logV)</span></p><p class="c4"><span class="c2">vector</span><span class="c1">&lt;</span><span class="c2">vector</span><span class="c8 c19">&lt;ii&gt;</span><span class="c1">&gt;</span><span class="c2">&nbsp;graph;</span></p><p class="c4"><span class="c2">vector</span><span class="c8 c19">&lt;int&gt;</span><span class="c2">&nbsp;dist;</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;dijkstra</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;s</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; dist</span><span class="c1">[</span><span class="c2">s</span><span class="c1">]=</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; priority_queue</span><span class="c1">&lt;</span><span class="c2">ii</span><span class="c1">,</span><span class="c2">vector</span><span class="c8 c19">&lt;ii&gt;</span><span class="c1">,</span><span class="c2">greater</span><span class="c8 c19">&lt;ii&gt;</span><span class="c1">&gt;</span><span class="c2">&nbsp;pq;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; pq</span><span class="c1">.</span><span class="c2">push</span><span class="c1">(</span><span class="c2">make_pair</span><span class="c1">(</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c2">&nbsp;s</span><span class="c1">));</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">while</span><span class="c1">(!</span><span class="c2">pq</span><span class="c1">.</span><span class="c2">empty</span><span class="c1">()){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; ii front</span><span class="c1">=</span><span class="c2">pq</span><span class="c1">.</span><span class="c2">top</span><span class="c1">();</span><span class="c2">pq</span><span class="c1">.</span><span class="c2">pop</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;d</span><span class="c1">=</span><span class="c2">front</span><span class="c1">.</span><span class="c2">first</span><span class="c1">,</span><span class="c2">u</span><span class="c1">=</span><span class="c2">front</span><span class="c1">.</span><span class="c2">second;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">d</span><span class="c1">==</span><span class="c2">dist</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">auto</span><span class="c2">&nbsp;p</span><span class="c1">:</span><span class="c2">graph</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;v</span><span class="c1">=</span><span class="c2">p</span><span class="c1">.</span><span class="c2">first</span><span class="c1">,</span><span class="c2">w</span><span class="c1">=</span><span class="c2">p</span><span class="c1">.</span><span class="c2">second;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">dist</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]+</span><span class="c2">w</span><span class="c1">&lt;</span><span class="c2">dist</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dist</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]=</span><span class="c2">dist</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]+</span><span class="c2">w;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pq</span><span class="c1">.</span><span class="c2">push</span><span class="c1">(</span><span class="c2">make_pair</span><span class="c1">(</span><span class="c2">dist</span><span class="c1">[</span><span class="c2">v</span><span class="c1">],</span><span class="c2">&nbsp;v</span><span class="c1">));</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Floyd-Warshall - all pairs shortest paths O(V^3)</span></p><p class="c4"><span>if dist[i][i]&lt;0 for any i , negative cycle exists.</span></p><p class="c4"><span class="c2">vector</span><span class="c1">&lt;</span><span class="c2">vector</span><span class="c8 c19">&lt;ii&gt;</span><span class="c1">&gt;</span><span class="c2">&nbsp;graph;</span></p><p class="c4"><span class="c2">vector</span><span class="c1">&lt;</span><span class="c2">vector</span><span class="c8 c19">&lt;int&gt;</span><span class="c1">&gt;</span><span class="c2">&nbsp;dist;</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;floyd_warshall</span><span class="c1">(){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// fill dist according to graph , dist[i][j]= weight of edge i-j / INF</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;n</span><span class="c1">=</span><span class="c2">graph</span><span class="c1">.</span><span class="c2">size</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;k </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;k </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;k</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;j </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;j </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;j</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dist</span><span class="c1">[</span><span class="c2">i</span><span class="c1">][</span><span class="c2">j</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;min</span><span class="c1">(</span><span class="c2">dist</span><span class="c1">[</span><span class="c2">i</span><span class="c1">][</span><span class="c2">j</span><span class="c1">],</span><span class="c2">&nbsp;dist</span><span class="c1">[</span><span class="c2">i</span><span class="c1">][</span><span class="c2">k</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">+</span><span class="c2">&nbsp;dist</span><span class="c1">[</span><span class="c2">k</span><span class="c1">][</span><span class="c2">j</span><span class="c1">]);</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Find bridges/cut-edges in a graph (O(V+E))</span></p><p class="c4"><span class="c2">vector</span><span class="c8 c19">&lt;int&gt;</span><span class="c2">&nbsp;low</span><span class="c1">,</span><span class="c2">idx</span><span class="c1">,</span><span class="c2">visited</span><span class="c1">,</span><span class="c2">parent;</span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;counter</span><span class="c1">=</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">vector</span><span class="c1">&lt;</span><span class="c2">vector</span><span class="c8 c19">&lt;int&gt;</span><span class="c1">&gt;</span><span class="c2">&nbsp;graph;</span></p><p class="c4"><span class="c2">vector</span><span class="c8 c19">&lt;ii&gt;</span><span class="c2">&nbsp;bridges;</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;find_bridges</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;u</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]=</span><span class="c2">idx</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]=</span><span class="c2">counter</span><span class="c1">++;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;v</span><span class="c1">:</span><span class="c2">graph</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(!</span><span class="c2">visited</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parent</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]=</span><span class="c2">u;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; visited</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]=</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; find_bridges</span><span class="c1">(</span><span class="c2">v</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">low</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]&gt;</span><span class="c2">idx</span><span class="c1">[</span><span class="c2">u</span><span class="c1">])</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bridges</span><span class="c1">.</span><span class="c2">pb</span><span class="c1">(</span><span class="c2">mp</span><span class="c1">(</span><span class="c2">u</span><span class="c1">,</span><span class="c2">v</span><span class="c1">));</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]=</span><span class="c2">min</span><span class="c1">(</span><span class="c2">low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">],</span><span class="c2">low</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c1">}</span><span class="c2">&nbsp;</span><span class="c8 c9">else</span><span class="c2">&nbsp;</span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">v</span><span class="c1">!=</span><span class="c2">parent</span><span class="c1">[</span><span class="c2">u</span><span class="c1">])</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]=</span><span class="c2">min</span><span class="c1">(</span><span class="c2">low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">],</span><span class="c2">idx</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c11"></span></p><p class="c4"><span class="c11">F</span><span class="c11">ind cut-vertices O(V+E)</span></p><p class="c4"><span class="c2 c3">vector</span><span class="c8 c19 c3">&lt;int&gt;</span><span class="c2 c3">&nbsp;low</span><span class="c0">,</span><span class="c2 c3">idx</span><span class="c0">,</span><span class="c2 c3">visited</span><span class="c0">,</span><span class="c2 c3">parent;</span></p><p class="c4"><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;counter</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">,</span><span class="c2 c3">root</span><span class="c0">,</span><span class="c2 c3">root_children;</span></p><p class="c4"><span class="c2 c3">vector</span><span class="c0">&lt;</span><span class="c2 c3">vector</span><span class="c8 c19 c3">&lt;int&gt;</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;graph;</span></p><p class="c4"><span class="c2 c3">vector</span><span class="c8 c19 c3">&lt;int&gt;</span><span class="c2 c3">&nbsp;cut_verts;</span></p><p class="c4"><span class="c8 c3 c9">void</span><span class="c2 c3">&nbsp;find_cut_verts</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;u</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; low</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]=</span><span class="c2 c3">idx</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]=</span><span class="c2 c3">counter</span><span class="c0">++;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;v</span><span class="c0">:</span><span class="c2 c3">graph</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(!</span><span class="c2 c3">visited</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parent</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]=</span><span class="c2 c3">u;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; visited</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]=</span><span class="c8 c12 c3">1;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">u</span><span class="c0">==</span><span class="c2 c3">root</span><span class="c0">)</span><span class="c2 c3">&nbsp;root_children</span><span class="c0">++;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; find_cut_verts</span><span class="c0">(</span><span class="c2 c3">v</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">low</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]&gt;=</span><span class="c2 c3">idx</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">])</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cut_verts</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]=</span><span class="c8 c12 c3">1;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; low</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]=</span><span class="c2 c3">min</span><span class="c0">(</span><span class="c2 c3">low</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">],</span><span class="c2 c3">low</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c0">}</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">else</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">v</span><span class="c0">!=</span><span class="c2 c3">parent</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">])</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; low</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]=</span><span class="c2 c3">min</span><span class="c0">(</span><span class="c2 c3">low</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">],</span><span class="c2 c3">idx</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">}</span></p><p class="c4"><span>call example</span></p><p class="c4"><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">i</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">;</span><span class="c2">i</span><span class="c1">++){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(!</span><span class="c2">visited</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; visited</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]=</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root</span><span class="c1">=</span><span class="c2">i;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root_children</span><span class="c1">=</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; find_cut_verts</span><span class="c1">(</span><span class="c2">i</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cut_verts</span><span class="c1">[</span><span class="c2">root</span><span class="c1">]=(</span><span class="c2">root_children</span><span class="c1">&gt;</span><span class="c8 c12">1</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c11">Find Strongly connected components O(V+E)</span></p><p class="c4"><span class="c2">vector</span><span class="c8 c19">&lt;int&gt;</span><span class="c2">&nbsp;low</span><span class="c1">,</span><span class="c2">idx</span><span class="c1">,</span><span class="c2">visited;</span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;counter</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c2">scc_counter</span><span class="c1">=</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">vector</span><span class="c1">&lt;</span><span class="c2">vector</span><span class="c8 c19">&lt;int&gt;</span><span class="c1">&gt;</span><span class="c2">&nbsp;graph;</span></p><p class="c4"><span class="c2">vector</span><span class="c8 c19">&lt;int&gt;</span><span class="c2">&nbsp;scc</span><span class="c1">,</span><span class="c2">scc_stack;</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;find_scc</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;u</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]=</span><span class="c2">idx</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]=</span><span class="c2">counter</span><span class="c1">++;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; scc_stack</span><span class="c1">.</span><span class="c2">push_back</span><span class="c1">(</span><span class="c2">u</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;v</span><span class="c1">:</span><span class="c2">graph</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">idx</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]==-</span><span class="c8 c12">1</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; visited</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]=</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; find_scc</span><span class="c1">(</span><span class="c2">v</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">visited</span><span class="c1">[</span><span class="c2">v</span><span class="c1">])</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]=</span><span class="c2">min</span><span class="c1">(</span><span class="c2">low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">],</span><span class="c2">low</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">low</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]==</span><span class="c2">idx</span><span class="c1">[</span><span class="c2">u</span><span class="c1">]){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; scc_counter</span><span class="c1">++;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">while</span><span class="c1">(</span><span class="c8 c12">1</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;v</span><span class="c1">=</span><span class="c2">scc_stack</span><span class="c1">.</span><span class="c2">back</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scc_stack</span><span class="c1">.</span><span class="c2">pop_back</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; visited</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]=</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scc</span><span class="c1">[</span><span class="c2">v</span><span class="c1">]=</span><span class="c2">scc_counter;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">u</span><span class="c1">==</span><span class="c2">v</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c8 c9">break;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4"><span>call</span></p><p class="c4"><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">i</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">;</span><span class="c2">i</span><span class="c1">++){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">idx</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]==-</span><span class="c8 c12">1</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; visited</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]=</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; find_scc</span><span class="c1">(</span><span class="c2">i</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4 c17"><span class="c20"></span></p><p class="c4"><span class="c11">Dinic algorithm for min cut max flow </span></p><p class="c4"><span class="c8 c3 c9">struct</span><span class="c2 c3">&nbsp;flow_graph{</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;MAX_V</span><span class="c0">,</span><span class="c2 c3">E</span><span class="c0">,</span><span class="c2 c3">s</span><span class="c0">,</span><span class="c2 c3">t</span><span class="c0">,</span><span class="c2 c3">head</span><span class="c0">,</span><span class="c2 c3">tail;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">cap</span><span class="c0">,*</span><span class="c2 c3">to</span><span class="c0">,*</span><span class="c8 c3 c9">next</span><span class="c0">,*</span><span class="c8 c3 c9">last</span><span class="c0">,*</span><span class="c2 c3">dist</span><span class="c0">,*</span><span class="c2 c3">q</span><span class="c0">,*</span><span class="c2 c3">now;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; flow_graph</span><span class="c0">(){}</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; flow_graph</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;V</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;MAX_E</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; MAX_V </span><span class="c0">=</span><span class="c2 c3">&nbsp;V</span><span class="c0">;</span><span class="c2 c3">&nbsp;E </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; cap </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">new</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c0">[</span><span class="c8 c12 c3">2</span><span class="c0">*</span><span class="c2 c3">MAX_E</span><span class="c0">],</span><span class="c2 c3">&nbsp;to </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">new</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c0">[</span><span class="c8 c12 c3">2</span><span class="c0">*</span><span class="c2 c3">MAX_E</span><span class="c0">],</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">next</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">new</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c0">[</span><span class="c8 c12 c3">2</span><span class="c0">*</span><span class="c2 c3">MAX_E</span><span class="c0">];</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">last</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">new</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c0">[</span><span class="c2 c3">MAX_V</span><span class="c0">],</span><span class="c2 c3">&nbsp;q </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">new</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c0">[</span><span class="c2 c3">MAX_V</span><span class="c0">],</span><span class="c2 c3">&nbsp;dist </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">new</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c0">[</span><span class="c2 c3">MAX_V</span><span class="c0">],</span><span class="c2 c3">&nbsp;now </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">new</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c0">[</span><span class="c2 c3">MAX_V</span><span class="c0">];</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; fill</span><span class="c0">(</span><span class="c8 c3 c9">last</span><span class="c0">,</span><span class="c8 c3 c9">last</span><span class="c0">+</span><span class="c2 c3">MAX_V</span><span class="c0">,-</span><span class="c8 c12 c3">1</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">void</span><span class="c2 c3">&nbsp;clear</span><span class="c0">(){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; fill</span><span class="c0">(</span><span class="c8 c3 c9">last</span><span class="c0">,</span><span class="c8 c3 c9">last</span><span class="c0">+</span><span class="c2 c3">MAX_V</span><span class="c0">,-</span><span class="c8 c12 c3">1</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; E </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">void</span><span class="c2 c3">&nbsp;add_edge</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;u</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;v</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;uv</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;vu </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; to</span><span class="c0">[</span><span class="c2 c3">E</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;v</span><span class="c0">,</span><span class="c2 c3">&nbsp;cap</span><span class="c0">[</span><span class="c2 c3">E</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;uv</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">next</span><span class="c0">[</span><span class="c2 c3">E</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">last</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">];</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">last</span><span class="c0">[</span><span class="c2 c3">u</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;E</span><span class="c0">++;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; to</span><span class="c0">[</span><span class="c2 c3">E</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;u</span><span class="c0">,</span><span class="c2 c3">&nbsp;cap</span><span class="c0">[</span><span class="c2 c3">E</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;vu</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">next</span><span class="c0">[</span><span class="c2 c3">E</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">last</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">];</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">last</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;E</span><span class="c0">++;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">bool</span><span class="c2 c3">&nbsp;bfs</span><span class="c0">(){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; fill</span><span class="c0">(</span><span class="c2 c3">dist</span><span class="c0">,</span><span class="c2 c3">dist</span><span class="c0">+</span><span class="c2 c3">MAX_V</span><span class="c0">,-</span><span class="c8 c12 c3">1</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; head </span><span class="c0">=</span><span class="c2 c3">&nbsp;tail </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; q</span><span class="c0">[</span><span class="c2 c3">tail</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;t</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">tail;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; dist</span><span class="c0">[</span><span class="c2 c3">t</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">while</span><span class="c0">(</span><span class="c2 c3">head</span><span class="c0">&lt;</span><span class="c2 c3">tail</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;v </span><span class="c0">=</span><span class="c2 c3">&nbsp;q</span><span class="c0">[</span><span class="c2 c3">head</span><span class="c0">];</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">head;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;e </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">last</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">];</span><span class="c2 c3">e</span><span class="c0">!=-</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3">e </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">next</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">cap</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">^</span><span class="c8 c12 c3">1</span><span class="c0">]&gt;</span><span class="c8 c12 c3">0</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;dist</span><span class="c0">[</span><span class="c2 c3">to</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]]==-</span><span class="c8 c12 c3">1</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q</span><span class="c0">[</span><span class="c2 c3">tail</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;to</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">];</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">tail;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dist</span><span class="c0">[</span><span class="c2 c3">to</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;dist</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]+</span><span class="c8 c12 c3">1;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;dist</span><span class="c0">[</span><span class="c2 c3">s</span><span class="c0">]!=-</span><span class="c8 c12 c3">1;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;dfs</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;v</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;f</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">v</span><span class="c0">==</span><span class="c2 c3">t</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;f;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;</span><span class="c2 c3">e </span><span class="c0">=</span><span class="c2 c3">&nbsp;now</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">];</span><span class="c2 c3">e</span><span class="c0">!=-</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3">e </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">next</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">cap</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]&gt;</span><span class="c8 c12 c3">0</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;dist</span><span class="c0">[</span><span class="c2 c3">to</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]]==</span><span class="c2 c3">dist</span><span class="c0">[</span><span class="c2 c3">v</span><span class="c0">]-</span><span class="c8 c12 c3">1</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;ret </span><span class="c0">=</span><span class="c2 c3">&nbsp;dfs</span><span class="c0">(</span><span class="c2 c3">to</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">],</span><span class="c2 c3">min</span><span class="c0">(</span><span class="c2 c3">f</span><span class="c0">,</span><span class="c2 c3">cap</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]));</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">ret</span><span class="c0">&gt;</span><span class="c8 c12 c3">0</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cap</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">-=</span><span class="c2 c3">&nbsp;ret;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cap</span><span class="c0">[</span><span class="c2 c3">e</span><span class="c0">^</span><span class="c8 c12 c3">1</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">+=</span><span class="c2 c3">&nbsp;ret;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;ret;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">long</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">long</span><span class="c2 c3">&nbsp;max_flow</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;source</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;sink</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; s </span><span class="c0">=</span><span class="c2 c3">&nbsp;source</span><span class="c0">;</span><span class="c2 c3">&nbsp;t </span><span class="c0">=</span><span class="c2 c3">&nbsp;sink;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">long</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">long</span><span class="c2 c3">&nbsp;f </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;x;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">while</span><span class="c0">(</span><span class="c2 c3">bfs</span><span class="c0">()){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">&lt;</span><span class="c2 c3">MAX_V</span><span class="c0">;++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3">&nbsp;now</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">last</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">];</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">while</span><span class="c0">(</span><span class="c8 c3 c9">true</span><span class="c0">){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="c0">=</span><span class="c2 c3">&nbsp;dfs</span><span class="c0">(</span><span class="c2 c3">s</span><span class="c0">,</span><span class="c2 c3">INF</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">x</span><span class="c0">==</span><span class="c8 c12 c3">0</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">break;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f </span><span class="c0">+=</span><span class="c2 c3">&nbsp;x;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c3 c9">return</span><span class="c2 c3">&nbsp;f;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c0">}</span><span class="c2 c3">&nbsp;G;</span></p><p class="c4 c17"><span class="c2 c3"></span></p><p class="c4"><span class="c6 c3">//sample for bipartite matching</span></p><p class="c4"><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;main</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;argc</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">const</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">char</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">&nbsp;argv</span><span class="c0">[])</span><span class="c2 c3">&nbsp;{</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;x</span><span class="c0">,</span><span class="c2 c3">y</span><span class="c0">,</span><span class="c2 c3">e</span><span class="c0">,</span><span class="c2 c3">u</span><span class="c0">,</span><span class="c2 c3">v;</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; scanf</span><span class="c0">(</span><span class="c8 c19 c3">&quot;%d %d %d&quot;</span><span class="c0">,&amp;</span><span class="c2 c3">x</span><span class="c0">,&amp;</span><span class="c2 c3">y</span><span class="c0">,&amp;</span><span class="c2 c3">e</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; G</span><span class="c0">=</span><span class="c2 c3">flow_graph</span><span class="c0">(</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">y</span><span class="c0">+</span><span class="c8 c12 c3">2</span><span class="c0">,</span><span class="c2 c3">e</span><span class="c0">+</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">y</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">&lt;</span><span class="c2 c3">e</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">++){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; scanf</span><span class="c0">(</span><span class="c8 c19 c3">&quot;%d %d&quot;</span><span class="c0">,&amp;</span><span class="c2 c3">u</span><span class="c0">,&amp;</span><span class="c2 c3">v</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; G</span><span class="c0">.</span><span class="c2 c3">add_edge</span><span class="c0">(</span><span class="c2 c3">u</span><span class="c0">,</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">v</span><span class="c0">,</span><span class="c8 c12 c3">1</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">&lt;</span><span class="c2 c3">x</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">++){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; G</span><span class="c0">.</span><span class="c2 c3">add_edge</span><span class="c0">(</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">y</span><span class="c0">,</span><span class="c2 c3">i</span><span class="c0">,</span><span class="c8 c12 c3">1</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c3 c9">for</span><span class="c0">(</span><span class="c8 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">&lt;</span><span class="c2 c3">y</span><span class="c0">;</span><span class="c2 c3">i</span><span class="c0">++){</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; G</span><span class="c0">.</span><span class="c2 c3">add_edge</span><span class="c0">(</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">i</span><span class="c0">,</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">y</span><span class="c0">+</span><span class="c8 c12 c3">1</span><span class="c0">,</span><span class="c8 c12 c3">1</span><span class="c0">);</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2 c3">&nbsp; &nbsp; printf</span><span class="c0">(</span><span class="c8 c19 c3">&quot;%lld\n&quot;</span><span class="c0">,</span><span class="c2 c3">G</span><span class="c0">.</span><span class="c2 c3">max_flow</span><span class="c0">(</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">y</span><span class="c0">,</span><span class="c2 c3">x</span><span class="c0">+</span><span class="c2 c3">y</span><span class="c0">+</span><span class="c8 c12 c3">1</span><span class="c0">));</span></p><p class="c4"><span class="c2 c3">}</span></p><p class="c4 c17"><span class="c8 c3 c9"></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">LCA</span><span class="c11">&nbsp;</span></p><p class="c4"><span class="c8 c11 c3 c9">const</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;max_nodes</span><span class="c0">,</span><span class="c2 c3">&nbsp;log_max_nodes</span><span class="c0">;</span><span class="c2 c3"><br></span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;num_nodes</span><span class="c0">,</span><span class="c2 c3">&nbsp;log_num_nodes</span><span class="c0">,</span><span class="c2 c3">&nbsp;root</span><span class="c0">;</span><span class="c2 c3"><br><br>vector</span><span class="c8 c19 c3">&lt;</span><span class="c8 c19 c11 c3">int</span><span class="c8 c19 c3">&gt;</span><span class="c2 c3">&nbsp;children</span><span class="c0">[</span><span class="c2 c3">max_nodes</span><span class="c0">];</span><span class="c2 c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6 c15 c3">// children[i] contains the children of node i</span><span class="c2 c3 c15"><br></span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">max_nodes</span><span class="c0">][</span><span class="c2 c3">log_max_nodes</span><span class="c0">+</span><span class="c8 c12 c3">1</span><span class="c0">];</span><span class="c2 c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6 c15 c3">// A[i][j] is the 2^j-th ancestor of node i, or -1 if that ancestor does not exist</span><span class="c2 c15 c3"><br></span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">max_nodes</span><span class="c0">];</span><span class="c2 c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6 c15 c3">// L[i] is the distance between node i and the root</span><span class="c2 c15 c3"><br></span><span class="c2 c3"><br></span><span class="c6 c15 c3">// floor of the binary logarithm of n</span><span class="c2 c15 c3"><br></span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;</span><span class="c2 c11 c3">lb</span><span class="c0">(</span><span class="c8 c11 c3 c9">unsigned</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;n</span><span class="c0">)</span><span class="c2 c3"><br></span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">n</span><span class="c0">==</span><span class="c8 c12 c3">0</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;p </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">n </span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">&lt;&lt;</span><span class="c8 c12 c3">16</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3">&nbsp;n </span><span class="c0">&gt;&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">16</span><span class="c0">;</span><span class="c2 c3">&nbsp;p </span><span class="c0">+=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">16</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">n </span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">&lt;&lt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">8</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3">&nbsp;n </span><span class="c0">&gt;&gt;=</span><span class="c2 c3">&nbsp; </span><span class="c8 c12 c3">8</span><span class="c0">;</span><span class="c2 c3">&nbsp;p </span><span class="c0">+=</span><span class="c2 c3">&nbsp; </span><span class="c8 c12 c3">8</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">n </span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">&lt;&lt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">4</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3">&nbsp;n </span><span class="c0">&gt;&gt;=</span><span class="c2 c3">&nbsp; </span><span class="c8 c12 c3">4</span><span class="c0">;</span><span class="c2 c3">&nbsp;p </span><span class="c0">+=</span><span class="c2 c3">&nbsp; </span><span class="c8 c12 c3">4</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">n </span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">&lt;&lt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">2</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3">&nbsp;n </span><span class="c0">&gt;&gt;=</span><span class="c2 c3">&nbsp; </span><span class="c8 c12 c3">2</span><span class="c0">;</span><span class="c2 c3">&nbsp;p </span><span class="c0">+=</span><span class="c2 c3">&nbsp; </span><span class="c8 c12 c3">2</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">n </span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">&lt;&lt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p </span><span class="c0">+=</span><span class="c2 c3">&nbsp; </span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;p</span><span class="c0">;</span><span class="c2 c3"><br></span><span class="c0">}</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">void</span><span class="c2 c3">&nbsp;</span><span class="c2 c11 c3">DFS</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;l</span><span class="c0">)</span><span class="c2 c3"><br></span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;l</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;j </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;j </span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;children</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">].</span><span class="c2 c3">size</span><span class="c0">();</span><span class="c2 c3">&nbsp;j</span><span class="c0">++)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DFS</span><span class="c0">(</span><span class="c2 c3">children</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">],</span><span class="c2 c3">&nbsp;l</span><span class="c0">+</span><span class="c8 c12 c3">1</span><span class="c0">);</span><span class="c2 c3"><br></span><span class="c0">}</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;</span><span class="c2 c11 c3">LCA</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;p</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;q</span><span class="c0">)</span><span class="c2 c3"><br></span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c6 c15 c3">// ensure node p is at least as deep as node q</span><span class="c2 c15 c3"><br></span><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">L</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">q</span><span class="c0">])</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap</span><span class="c0">(</span><span class="c2 c3">p</span><span class="c0">,</span><span class="c2 c3">&nbsp;q</span><span class="c0">);</span><span class="c2 c3"><br><br> &nbsp; &nbsp;</span><span class="c6 c15 c3">// &quot;binary search&quot; for the ancestor of node p situated on the same level as q</span><span class="c2 c15 c3"><br></span><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c11 c3 c9">for</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;log_num_nodes</span><span class="c0">;</span><span class="c2 c3">&nbsp;i </span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">--)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">L</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c12 c3">1</span><span class="c0">&lt;&lt;</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">q</span><span class="c0">])</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;p </span><span class="c0">=</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br> &nbsp; &nbsp;<br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">p </span><span class="c0">==</span><span class="c2 c3">&nbsp;q</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;p</span><span class="c0">;</span><span class="c2 c3"><br><br> &nbsp; &nbsp;</span><span class="c6 c15 c3">// &quot;binary search&quot; for the LCA</span><span class="c2 c15 c3"><br></span><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c11 c3 c9">for</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;log_num_nodes</span><span class="c0">;</span><span class="c2 c3">&nbsp;i </span><span class="c0">&gt;=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">--)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">A</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">!=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">!=</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">q</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">])</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;p </span><span class="c0">=</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;q </span><span class="c0">=</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">q</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;<br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">][</span><span class="c8 c12 c3">0</span><span class="c0">];</span><span class="c2 c3"><br></span><span class="c0">}</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;</span><span class="c2 c11 c3">main</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;argc</span><span class="c0">,</span><span class="c8 c11 c3 c9">char</span><span class="c0">*</span><span class="c2 c3">&nbsp;argv</span><span class="c0">[])</span><span class="c2 c3"><br></span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c6 c15 c3">// read num_nodes, the total number of nodes</span><span class="c2 c15 c3"><br></span><span class="c2 c3">&nbsp; &nbsp; log_num_nodes</span><span class="c0">=</span><span class="c2 c3">lb</span><span class="c0">(</span><span class="c2 c3">num_nodes</span><span class="c0">);</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i </span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;num_nodes</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">++)</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;p</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6 c15 c3">// read p, the parent of node i or -1 if node i is the root</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c8 c12 c3">0</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;p</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">p </span><span class="c0">!=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;children</span><span class="c0">[</span><span class="c2 c3">p</span><span class="c0">].</span><span class="c2 c3">push_back</span><span class="c0">(</span><span class="c2 c3">i</span><span class="c0">);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">else</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;root </span><span class="c0">=</span><span class="c2 c3">&nbsp;i</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c6 c15 c3">// precompute A using dynamic programming</span><span class="c2 c15 c3"><br></span><span class="c2 c3">&nbsp; &nbsp; </span><span class="c8 c11 c3 c9">for</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;j </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3">&nbsp;j </span><span class="c0">&lt;=</span><span class="c2 c3">&nbsp;log_num_nodes</span><span class="c0">;</span><span class="c2 c3">&nbsp;j</span><span class="c0">++)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i </span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;num_nodes</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">++)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">A</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">!=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;A</span><span class="c0">[</span><span class="c2 c3">A</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">]][</span><span class="c2 c3">j</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">else</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c6 c15 c3">// precompute L</span><span class="c2 c15 c3"><br></span><span class="c2 c3">&nbsp; &nbsp; DFS</span><span class="c0">(</span><span class="c2 c3">root</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">);</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br>}</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11 c31">Ad-hoc</span></p><p class="c4"><span class="c11">Josephus problem: O(n) </span><span>against naive O(n^2)</span></p><ul class="c16 lst-kix_p6zo5vs9euaf-0 start"><li class="c4 c10"><span>josephus(n, k) = (josephus(n - 1, k) + k-1) % n + 1</span></li><li class="c4 c10"><span>&nbsp;josephus(1, k) = 1</span></li></ul><p class="c4"><span>For small k we can do in O(k log n):</span></p><p class="c4"><span class="c13">int joseph (int n, int k) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (n == 1) &nbsp;return 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (k == 1) &nbsp;return n-1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (k &gt; n) &nbsp;return (joseph (n-1, k) + k) % n;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int cnt = n / k;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int res = joseph (n - cnt, k);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res -= n % k;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (res &lt; 0) &nbsp;res += n;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else &nbsp;res += res / (k - 1);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return res;<br>}</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Binary search</span></p><p class="c4"><span>over reals </span></p><p class="c4"><span class="c8 c9">const</span><span class="c2">&nbsp;</span><span class="c8 c9">double</span><span class="c2">&nbsp;eps</span><span class="c1">=</span><span class="c8 c12">1e-7;</span></p><p class="c4"><span class="c8 c9">double</span><span class="c2">&nbsp;l</span><span class="c1">=</span><span class="c2">eps</span><span class="c1">,</span><span class="c2">r</span><span class="c1">=</span><span class="c8 c12">10000.0</span><span class="c1">/</span><span class="c2">eps;</span></p><p class="c4"><span class="c8 c9">while</span><span class="c1">(</span><span class="c2">abs</span><span class="c1">(</span><span class="c2">r</span><span class="c1">-</span><span class="c2">l</span><span class="c1">)&gt;</span><span class="c2">eps</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">double</span><span class="c2">&nbsp;mid</span><span class="c1">=(</span><span class="c2">l</span><span class="c1">+</span><span class="c2">r</span><span class="c1">)/</span><span class="c8 c12">2.0;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">check</span><span class="c1">(</span><span class="c2">mid</span><span class="c1">))</span><span class="c2">&nbsp;r</span><span class="c1">=</span><span class="c2">mid;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">else</span><span class="c2">&nbsp; l</span><span class="c1">=</span><span class="c2">mid</span><span class="c1">+</span><span class="c2">eps;</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c20"></span></p><p class="c4 c17"><span class="c20"></span></p><p class="c4"><span>over ints - gives last index where check returns false.</span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;l</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c2">r</span><span class="c1">=</span><span class="c8 c12">100;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">while</span><span class="c1">(</span><span class="c2">l</span><span class="c1">&lt;</span><span class="c2">r</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;mid</span><span class="c1">=</span><span class="c2">l</span><span class="c1">+(</span><span class="c2">r</span><span class="c1">-</span><span class="c2">l</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">)/</span><span class="c8 c12">2;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">check</span><span class="c1">(</span><span class="c2">mid</span><span class="c1">))</span><span class="c2">&nbsp;r</span><span class="c1">=</span><span class="c2">mid</span><span class="c1">-</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">else</span><span class="c2">&nbsp;l</span><span class="c1">=</span><span class="c2">mid;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><h2 class="c4 c29" id="h.8u5acqacuxi2"><span>Number Theory</span></h2><p class="c4"><span class="c11">Extended euclid algorithm</span></p><p class="c4"><span>solves ax+by=gcd(a,b) ,returns (gcd,(x,y))</span></p><p class="c4"><span>x+k(b/gcd),y-k(a/gcd) give all solutions</span></p><p class="c4"><span class="c2">pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c2">pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c1">&gt;&gt;</span><span class="c2">&nbsp;extended_euclid</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;a</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c2">&nbsp;b</span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">a</span><span class="c1">==</span><span class="c8 c12">0</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c8 c9">return</span><span class="c2">&nbsp;make_pair</span><span class="c1">(</span><span class="c2">b</span><span class="c1">,</span><span class="c2">make_pair</span><span class="c1">(</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c8 c12">1</span><span class="c1">));</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">auto</span><span class="c2">&nbsp;</span><span class="c8 c9">sub</span><span class="c1">=</span><span class="c2">extended_euclid</span><span class="c1">(</span><span class="c2">b</span><span class="c1">%</span><span class="c2">a</span><span class="c1">,</span><span class="c2">a</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;x1</span><span class="c1">=</span><span class="c8 c9">sub</span><span class="c1">.</span><span class="c2">second</span><span class="c1">.</span><span class="c2">first</span><span class="c1">,</span><span class="c2">y1</span><span class="c1">=</span><span class="c8 c9">sub</span><span class="c1">.</span><span class="c2">second</span><span class="c1">.</span><span class="c2">second;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;x</span><span class="c1">=</span><span class="c2">y1</span><span class="c1">-(</span><span class="c2">b</span><span class="c1">/</span><span class="c2">a</span><span class="c1">)*</span><span class="c2">x1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;y</span><span class="c1">=</span><span class="c2">x1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">sub</span><span class="c1">.</span><span class="c2">second</span><span class="c1">=</span><span class="c2">make_pair</span><span class="c1">(</span><span class="c2">x</span><span class="c1">,</span><span class="c2">&nbsp;y</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;</span><span class="c8 c9">sub;</span></p><p class="c4"><span class="c2">}</span></p><p class="c4"><span>to solve ax+by=c (c=d*gcd) use d*x,d*y</span></p><p class="c4"><span>to find modular inverse ax=b(mod m), solve &nbsp;ax+my=b</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Fibonacci</span><span>: </span><span class="c25">F(n) = ((phi)^n - (psi)^n)/sqrt(5);</span></p><p class="c4"><span class="c25">phi = (1+sqrt(5))/2, psi = (1-sqrt(5))/2</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Factorial divider</span><span>: gives largest x such that n=alpha*k^x (slightly useless :P)</span></p><p class="c4"><span class="c13">int fact_pow (int n, int k) {</span></p><p class="c4"><span class="c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int res = 0;</span></p><p class="c4"><span class="c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (n) {</span></p><p class="c4"><span class="c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n /= k;</span></p><p class="c4"><span class="c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res += n;</span></p><p class="c4"><span class="c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c4"><span class="c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return res;</span></p><p class="c4"><span class="c13">}</span></p><p class="c4 c17"><span class="c8"></span></p><p class="c4"><span class="c11 c25">Gauss&rsquo; Theorem to solve Ax=B system of linear equations: </span><span class="c25">m variables, n </span></p><p class="c4"><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;gauss </span><span class="c0">(</span><span class="c2 c3">vector </span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;vector</span><span class="c8 c19 c3">&lt;</span><span class="c8 c19 c11 c3">double</span><span class="c8 c19 c3">&gt;</span><span class="c2 c3">&nbsp;</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;a</span><span class="c0">,</span><span class="c2 c3">&nbsp;vector</span><span class="c8 c19 c3">&lt;</span><span class="c8 c19 c11 c3">double</span><span class="c8 c19 c3">&gt;</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;</span><span class="c2 c3">&nbsp;ans</span><span class="c0">)</span><span class="c2 c3">&nbsp;{</span></p><p class="c4"><span class="c6 c3">// a: n rows and n+1 cols - n equations, n variables; last col is constants on RHS</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;n </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c0">)</span><span class="c2 c3">&nbsp;a</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">();</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;m </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c0">)</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c8 c12 c3">0</span><span class="c0">].</span><span class="c2 c3">size</span><span class="c0">()</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vector</span><span class="c8 c19 c3">&lt;</span><span class="c8 c19 c11 c3">int</span><span class="c8 c19 c3">&gt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">where</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">m</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;col</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">,</span><span class="c2 c3">&nbsp;row</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;col</span><span class="c0">&lt;</span><span class="c2 c3">m </span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;row</span><span class="c0">&lt;</span><span class="c2 c3">n</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">col</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;sel </span><span class="c0">=</span><span class="c2 c3">&nbsp;row</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c2 c3">row</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">n</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">abs </span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">col</span><span class="c0">])</span><span class="c2 c3">&nbsp;</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;abs </span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">[</span><span class="c2 c3">sel</span><span class="c0">][</span><span class="c2 c3">col</span><span class="c0">]))</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sel </span><span class="c0">=</span><span class="c2 c3">&nbsp;i</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">abs </span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">[</span><span class="c2 c3">sel</span><span class="c0">][</span><span class="c2 c3">col</span><span class="c0">])</span><span class="c2 c3">&nbsp;</span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;EPS</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">continue</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c2 c3">col</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;=</span><span class="c2 c3">m</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap </span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">[</span><span class="c2 c3">sel</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">],</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">row</span><span class="c0">][</span><span class="c2 c3">i</span><span class="c0">]);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c3 c9">where</span><span class="c0">[</span><span class="c2 c3">col</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;row</span><span class="c0">;</span><span class="c2 c3"><br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">n</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i </span><span class="c0">!=</span><span class="c2 c3">&nbsp;row</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">double</span><span class="c2 c3">&nbsp;c </span><span class="c0">=</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">col</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">/</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">row</span><span class="c0">][</span><span class="c2 c3">col</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;j</span><span class="c0">=</span><span class="c2 c3">col</span><span class="c0">;</span><span class="c2 c3">&nbsp;j</span><span class="c0">&lt;=</span><span class="c2 c3">m</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">j</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">-=</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">row</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">&nbsp;c</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">++</span><span class="c2 c3">row</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans</span><span class="c0">.</span><span class="c2 c3">assign </span><span class="c0">(</span><span class="c2 c3">m</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">m</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c3 c9">where</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">!=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c8 c3 c9">where</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]][</span><span class="c2 c3">m</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">/</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c8 c3 c9">where</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]][</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">n</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">double</span><span class="c2 c3">&nbsp;sum </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;j</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;j</span><span class="c0">&lt;</span><span class="c2 c3">m</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">j</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum </span><span class="c0">+=</span><span class="c2 c3">&nbsp;ans</span><span class="c0">[</span><span class="c2 c3">j</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">j</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">abs </span><span class="c0">(</span><span class="c2 c3">sum </span><span class="c0">-</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">][</span><span class="c2 c3">m</span><span class="c0">])</span><span class="c2 c3">&nbsp;</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;EPS</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">m</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c3 c9">where</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">==</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;INF</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br>}</span></p><p class="c4 c17"><span class="c8 c27 c3"></span></p><p class="c4"><span class="c27 c3">Determinant of a matrix a: O(n^3)</span></p><p class="c4"><span class="c8 c9">const</span><span class="c2">&nbsp;</span><span class="c8 c9">double</span><span class="c2">&nbsp;EPS </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">1E-9</span><span class="c1">;</span><span class="c2"><br></span><span class="c8 c9">int</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2"><br>vector </span><span class="c1">&lt;</span><span class="c2">&nbsp;vector</span><span class="c8 c19">&lt;double&gt;</span><span class="c2">&nbsp;</span><span class="c1">&gt;</span><span class="c2">&nbsp;a </span><span class="c1">(</span><span class="c2">n</span><span class="c1">,</span><span class="c2">&nbsp;vector</span><span class="c8 c19">&lt;double&gt;</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">n</span><span class="c1">));</span><span class="c2"><br></span><span class="c6">// ..., And reading a ... n</span><span class="c2"><br><br></span><span class="c8 c9">double</span><span class="c2">&nbsp;it </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2"><br></span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c1">++</span><span class="c2">i</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">{</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;k </span><span class="c1">=</span><span class="c2">&nbsp;i</span><span class="c1">;</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;j</span><span class="c1">=</span><span class="c2">i</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;j</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c1">++</span><span class="c2">j</span><span class="c1">)</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">abs </span><span class="c1">(</span><span class="c2">a</span><span class="c1">[</span><span class="c2">j</span><span class="c1">][</span><span class="c2">i</span><span class="c1">])</span><span class="c2">&nbsp;</span><span class="c1">&gt;</span><span class="c2">&nbsp;abs </span><span class="c1">(</span><span class="c2">a</span><span class="c1">[</span><span class="c2">k</span><span class="c1">][</span><span class="c2">i</span><span class="c1">]))</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k </span><span class="c1">=</span><span class="c2">&nbsp;j</span><span class="c1">;</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">abs </span><span class="c1">(</span><span class="c2">a</span><span class="c1">[</span><span class="c2">k</span><span class="c1">][</span><span class="c2">i</span><span class="c1">])</span><span class="c2">&nbsp;</span><span class="c1">&lt;</span><span class="c2">&nbsp;EPS</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">{</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">break</span><span class="c1">;</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">}</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap </span><span class="c1">(</span><span class="c2">a</span><span class="c1">[</span><span class="c2">i</span><span class="c1">],</span><span class="c2">&nbsp;a</span><span class="c1">[</span><span class="c2">k</span><span class="c1">]);</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">!=</span><span class="c2">&nbsp;k</span><span class="c1">)</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c2">it</span><span class="c1">;</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;det </span><span class="c1">*=</span><span class="c2">&nbsp;a</span><span class="c1">[</span><span class="c2">i</span><span class="c1">][</span><span class="c2">i</span><span class="c1">];</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;j</span><span class="c1">=</span><span class="c2">i</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;j</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c1">++</span><span class="c2">j</span><span class="c1">)</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a</span><span class="c1">[</span><span class="c2">i</span><span class="c1">][</span><span class="c2">j</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">/=</span><span class="c2">&nbsp;a</span><span class="c1">[</span><span class="c2">i</span><span class="c1">][</span><span class="c2">i</span><span class="c1">];</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;j</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;j</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c1">++</span><span class="c2">j</span><span class="c1">)</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">j </span><span class="c1">!=</span><span class="c2">&nbsp;i </span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;abs </span><span class="c1">(</span><span class="c2">a</span><span class="c1">[</span><span class="c2">j</span><span class="c1">][</span><span class="c2">i</span><span class="c1">])</span><span class="c2">&nbsp;</span><span class="c1">&gt;</span><span class="c2">&nbsp;EPS</span><span class="c1">)</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;k</span><span class="c1">=</span><span class="c2">i</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;k</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c1">++</span><span class="c2">k</span><span class="c1">)</span><span class="c2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a</span><span class="c1">[</span><span class="c2">j</span><span class="c1">][</span><span class="c2">k</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">-=</span><span class="c2">&nbsp;a</span><span class="c1">[</span><span class="c2">i</span><span class="c1">][</span><span class="c2">k</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">&nbsp;a</span><span class="c1">[</span><span class="c2">j</span><span class="c1">][</span><span class="c2">i</span><span class="c1">];</span><span class="c2"><br></span><span class="c1">}</span><span class="c2"><br>cout </span><span class="c1">&lt;&lt;</span><span class="c2">&nbsp;det;</span></p><p class="c4 c17"><span class="c2 c3"></span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Geometry</span></p><p class="c4"><span class="c11">Convex Hull problem: O(N log N)</span></p><p class="c4"><span class="c8 c11 c3 c9">struct</span><span class="c2 c3">&nbsp;pt </span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">double</span><span class="c2 c3">&nbsp;x</span><span class="c0">,</span><span class="c2 c3">&nbsp;y</span><span class="c0">;</span><span class="c2 c3"><br></span><span class="c0">};</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">bool</span><span class="c2 c3">&nbsp;cmp </span><span class="c0">(</span><span class="c2 c3">pt a</span><span class="c0">,</span><span class="c2 c3">&nbsp;pt b</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;a</span><span class="c0">.</span><span class="c2 c3">x </span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;b</span><span class="c0">.</span><span class="c2 c3">x </span><span class="c0">||</span><span class="c2 c3">&nbsp;a</span><span class="c0">.</span><span class="c2 c3">x </span><span class="c0">==</span><span class="c2 c3">&nbsp;b</span><span class="c0">.</span><span class="c2 c3">x </span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;a</span><span class="c0">.</span><span class="c2 c3">y </span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;b</span><span class="c0">.</span><span class="c2 c3">y</span><span class="c0">;</span><span class="c2 c3"><br></span><span class="c0">}</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">bool</span><span class="c2 c3">&nbsp;cw </span><span class="c0">(</span><span class="c2 c3">pt a</span><span class="c0">,</span><span class="c2 c3">&nbsp;pt b</span><span class="c0">,</span><span class="c2 c3">&nbsp;pt c</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;x </span><span class="c0">*</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c3 c9">by</span><span class="c0">-</span><span class="c2 c3">cy</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;bx </span><span class="c0">*</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">cy</span><span class="c0">-</span><span class="c2 c3">ay</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;cx </span><span class="c0">*</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">ay</span><span class="c0">-</span><span class="c8 c3 c9">by</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">&lt;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br></span><span class="c0">}</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">bool</span><span class="c2 c3">&nbsp;ccw </span><span class="c0">(</span><span class="c2 c3">pt a</span><span class="c0">,</span><span class="c2 c3">&nbsp;pt b</span><span class="c0">,</span><span class="c2 c3">&nbsp;pt c</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;x </span><span class="c0">*</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c3 c9">by</span><span class="c0">-</span><span class="c2 c3">cy</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;bx </span><span class="c0">*</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">cy</span><span class="c0">-</span><span class="c2 c3">ay</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;cx </span><span class="c0">*</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">ay</span><span class="c0">-</span><span class="c8 c3 c9">by</span><span class="c0">)&gt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br>}</span></p><p class="c4"><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">void</span><span class="c2 c3">&nbsp;convex_hull </span><span class="c0">(</span><span class="c2 c3">vector</span><span class="c8 c19 c3">&lt;pt&gt;</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;</span><span class="c2 c3">&nbsp;a</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()</span><span class="c2 c3">&nbsp;</span><span class="c0">==</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3">&nbsp; </span><span class="c8 c11 c3 c9">return</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort </span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">.</span><span class="c8 c3 c9">begin</span><span class="c0">(),</span><span class="c2 c3">&nbsp;a</span><span class="c0">.</span><span class="c8 c3 c9">end</span><span class="c0">(),</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;</span><span class="c2 c3">cmp</span><span class="c0">);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt p1 </span><span class="c0">=</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c8 c12 c3">0</span><span class="c0">],</span><span class="c2 c3">&nbsp; p2 </span><span class="c0">=</span><span class="c2 c3">&nbsp;a</span><span class="c0">.</span><span class="c2 c3">back</span><span class="c0">();</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vector</span><span class="c8 c19 c3">&lt;pt&gt;</span><span class="c2 c3">&nbsp;up</span><span class="c0">,</span><span class="c2 c3">&nbsp;down</span><span class="c0">;</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;up</span><span class="c0">.</span><span class="c2 c3">push_back </span><span class="c0">(</span><span class="c2 c3">p1</span><span class="c0">);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down</span><span class="c0">.</span><span class="c2 c3">push_back </span><span class="c0">(</span><span class="c2 c3">p1</span><span class="c0">);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c22 c3">size_t</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">a</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">();</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i</span><span class="c0">==</span><span class="c2 c3">a</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()-</span><span class="c8 c12 c3">1</span><span class="c2 c3">&nbsp;</span><span class="c0">||</span><span class="c2 c3">&nbsp;cw </span><span class="c0">(</span><span class="c2 c3">p1</span><span class="c0">,</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">],</span><span class="c2 c3">&nbsp;p2</span><span class="c0">))</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">while</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">up</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()&gt;=</span><span class="c8 c12 c3">2</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;</span><span class="c0">!</span><span class="c2 c3">cw </span><span class="c0">(</span><span class="c2 c3">up</span><span class="c0">[</span><span class="c2 c3">up</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()-</span><span class="c8 c12 c3">2</span><span class="c0">],</span><span class="c2 c3">&nbsp;up</span><span class="c0">[</span><span class="c2 c3">up</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()-</span><span class="c8 c12 c3">1</span><span class="c0">],</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]))</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;up</span><span class="c0">.</span><span class="c2 c3">pop_back</span><span class="c0">();</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;up</span><span class="c0">.</span><span class="c2 c3">push_back </span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i</span><span class="c0">==</span><span class="c2 c3">a</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()-</span><span class="c8 c12 c3">1</span><span class="c2 c3">&nbsp;</span><span class="c0">||</span><span class="c2 c3">&nbsp;ccw </span><span class="c0">(</span><span class="c2 c3">p1</span><span class="c0">,</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">],</span><span class="c2 c3">&nbsp;p2</span><span class="c0">))</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">while</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">down</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()&gt;=</span><span class="c8 c12 c3">2</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;</span><span class="c0">!</span><span class="c2 c3">ccw </span><span class="c0">(</span><span class="c2 c3">down</span><span class="c0">[</span><span class="c2 c3">down</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()-</span><span class="c8 c12 c3">2</span><span class="c0">],</span><span class="c2 c3">&nbsp;down</span><span class="c0">[</span><span class="c2 c3">down</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()-</span><span class="c8 c12 c3">1</span><span class="c0">],</span><span class="c2 c3">&nbsp;a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]))</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down</span><span class="c0">.</span><span class="c2 c3">pop_back</span><span class="c0">();</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;down</span><span class="c0">.</span><span class="c2 c3">push_back </span><span class="c0">(</span><span class="c2 c3">a</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0">}</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a</span><span class="c0">.</span><span class="c2 c3">clear</span><span class="c0">();</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c3 c22">size_t</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">up</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">();</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a</span><span class="c0">.</span><span class="c2 c3">push_back </span><span class="c0">(</span><span class="c2 c3">up</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]);</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c22 c3">size_t</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c2 c3">down</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">()-</span><span class="c8 c12 c3">2</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&gt;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c0">--</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a</span><span class="c0">.</span><span class="c2 c3">push_back </span><span class="c0">(</span><span class="c2 c3">down</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]);</span><span class="c2 c3"><br>}</span></p><p class="c4"><span class="c11">Polygon area</span></p><p class="c4"><span>&frac12;sum of (x[i-1]+x[i])(y[i-1]-y[i]) for i = 0 to n (cyclic : -1 -&gt; n-1)</span></p><h2 class="c4 c26" id="h.rnhl1fi6p0qu"><span></span></h2><h2 class="c4 c29" id="h.9ftyxigsje"><span>S</span><span>tring algorithms</span></h2><p class="c4"><span class="c11">Rabin-Karp: O(strlen(s))</span></p><p class="c4"><span class="c8 c3 c9">string</span><span class="c2 c3">&nbsp;s</span><span class="c0">,</span><span class="c2 c3">&nbsp;t</span><span class="c0">;</span><span class="c2 c3">&nbsp;</span><span class="c6 c3">// s is text, t is pattern</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">const</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;p </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">31</span><span class="c0">;</span><span class="c2 c3"><br>vector</span><span class="c0">&lt;</span><span class="c8 c11 c3 c9">long</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">long</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;p_pow </span><span class="c0">(</span><span class="c2 c3">max </span><span class="c0">(</span><span class="c2 c3">s</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">(),</span><span class="c2 c3">&nbsp;t</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">()));</span><span class="c2 c3"><br>p_pow</span><span class="c0">[</span><span class="c8 c12 c3">0</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br></span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c22 c3">size_t</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">p_pow</span><span class="c0">.</span><span class="c2 c3">size</span><span class="c0">();</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_pow</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;p_pow</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">&nbsp;p</span><span class="c0">;</span><span class="c2 c3"><br><br>vector</span><span class="c0">&lt;</span><span class="c8 c3 c9 c11">long</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">long</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;h </span><span class="c0">(</span><span class="c2 c3">t</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">());</span><span class="c2 c3"><br></span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c22 c3">size_t</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">t</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">();</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br></span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">t</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c2 c3">&nbsp;</span><span class="c8 c19 c3">&#39;a&#39;</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">&nbsp;p_pow</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3">&nbsp; h</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">+=</span><span class="c2 c3">&nbsp;h</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">];</span><span class="c2 c3"><br></span><span class="c0">}</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">long</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">long</span><span class="c2 c3">&nbsp;h_s </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br></span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c22 c3">size_t</span><span class="c2 c3">&nbsp;i</span><span class="c0">=</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">&lt;</span><span class="c2 c3">s</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">();</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h_s </span><span class="c0">+=</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">s</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c2 c3">&nbsp;</span><span class="c8 c19 c3">&#39;a&#39;</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">&nbsp;p_pow</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br><br></span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c8 c22 c3">size_t</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3">&nbsp;i </span><span class="c0">+</span><span class="c2 c3">&nbsp;s</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">()</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c2 c3">&nbsp;</span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;t</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">();</span><span class="c2 c3">&nbsp;</span><span class="c0">++</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3"><br></span><span class="c0">{</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">long</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">long</span><span class="c2 c3">&nbsp;cur_h </span><span class="c0">=</span><span class="c2 c3">&nbsp;h</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">+</span><span class="c2 c3">s</span><span class="c0">.</span><span class="c2 c3">length</span><span class="c0">()-</span><span class="c8 c12 c3">1</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i</span><span class="c0">)</span><span class="c2 c3">&nbsp; cur_h </span><span class="c0">-=</span><span class="c2 c3">&nbsp;h</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">];</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">cur_h </span><span class="c0">==</span><span class="c2 c3">&nbsp;h_s </span><span class="c0">*</span><span class="c2 c3">&nbsp;p_pow</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">])</span><span class="c2 c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout </span><span class="c0">&lt;&lt;</span><span class="c2 c3">&nbsp;i </span><span class="c0">&lt;&lt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c19 c3">&#39; &#39;</span><span class="c0">;</span><span class="c2 c3"><br>}</span></p><p class="c4 c17"><span class="c11"></span></p><p class="c4"><span class="c11">Manacher&rsquo;s algorithm: O(n); search for the longest palindromic substring</span><span>&nbsp;(no idea how this works, it has a tutorial for over 4 pages)</span></p><p class="c4"><span class="c2 c3">pair</span><span class="c0">&lt;</span><span class="c8 c11 c3 c9">int</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;getPStr</span><span class="c0">(</span><span class="c8 c11 c3 c9">char</span><span class="c2 c3">&nbsp;</span><span class="c0">*</span><span class="c2 c3">text</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;N </span><span class="c0">=</span><span class="c2 c3">&nbsp;strlen</span><span class="c0">(</span><span class="c2 c3">text</span><span class="c0">);</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">N </span><span class="c0">==</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">)</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;N </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">2</span><span class="c0">*</span><span class="c2 c3">N </span><span class="c0">+</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">N</span><span class="c0">];</span><span class="c2 c3"><br> &nbsp; &nbsp;L</span><span class="c0">[</span><span class="c8 c12 c3">0</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;L</span><span class="c0">[</span><span class="c8 c12 c3">1</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">int</span><span class="c2 c3">&nbsp;C </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">,</span><span class="c2 c3">&nbsp;R </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">2</span><span class="c0">,</span><span class="c2 c3">&nbsp;i </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">,</span><span class="c2 c3">&nbsp;iMirror</span><span class="c0">,</span><span class="c2 c3">&nbsp;maxLPSLength </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">,</span><span class="c2 c3">&nbsp;maxLPSCenterPosition </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">,</span><span class="c2 c3">&nbsp;start </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">end</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">,</span><span class="c2 c3">&nbsp;diff </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">for</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">2</span><span class="c0">;</span><span class="c2 c3">&nbsp;i </span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;N</span><span class="c0">;</span><span class="c2 c3">&nbsp;i</span><span class="c0">++)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;iMirror &nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">2</span><span class="c0">*</span><span class="c2 c3">C</span><span class="c0">-</span><span class="c2 c3">i</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;diff </span><span class="c0">=</span><span class="c2 c3">&nbsp;R </span><span class="c0">-</span><span class="c2 c3">&nbsp;i</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">diff </span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">L</span><span class="c0">[</span><span class="c2 c3">iMirror</span><span class="c0">]&lt;</span><span class="c2 c3">diff</span><span class="c0">)</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]=</span><span class="c2 c3">L</span><span class="c0">[</span><span class="c2 c3">iMirror</span><span class="c0">];</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c8 c11 c3 c9">else</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]=</span><span class="c2 c3">diff</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">while</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">&nbsp;</span><span class="c0">((</span><span class="c2 c3">i </span><span class="c0">+</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">])</span><span class="c2 c3">&nbsp;</span><span class="c0">&lt;</span><span class="c2 c3">&nbsp;N </span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i </span><span class="c0">-</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">])</span><span class="c2 c3">&nbsp;</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">&amp;&amp;</span><span class="c2 c3">&nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">(</span><span class="c2 c3">&nbsp;</span><span class="c0">((</span><span class="c2 c3">i </span><span class="c0">+</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">%</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">2</span><span class="c2 c3">&nbsp;</span><span class="c0">==</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">0</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">||</span><span class="c2 c3">&nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">(</span><span class="c2 c3">text</span><span class="c0">[(</span><span class="c2 c3">i </span><span class="c0">+</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">+</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">)/</span><span class="c8 c12 c3">2</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">==</span><span class="c2 c3">&nbsp;text</span><span class="c0">[(</span><span class="c2 c3">i </span><span class="c0">-</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">-</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">)/</span><span class="c8 c12 c3">2</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">)))</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]++;</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> <br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c0">(</span><span class="c2 c3">L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;maxLPSLength</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;maxLPSLength </span><span class="c0">=</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;maxLPSCenterPosition </span><span class="c0">=</span><span class="c2 c3">&nbsp;i</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">if</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">i </span><span class="c0">+</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">]</span><span class="c2 c3">&nbsp;</span><span class="c0">&gt;</span><span class="c2 c3">&nbsp;R</span><span class="c0">)</span><span class="c2 c3">&nbsp;</span><span class="c0">{</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;C </span><span class="c0">=</span><span class="c2 c3">&nbsp;i</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;R </span><span class="c0">=</span><span class="c2 c3">&nbsp;i </span><span class="c0">+</span><span class="c2 c3">&nbsp;L</span><span class="c0">[</span><span class="c2 c3">i</span><span class="c0">];</span><span class="c2 c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c0">}</span><span class="c2 c3"><br> &nbsp; &nbsp;start </span><span class="c0">=</span><span class="c2 c3">&nbsp;</span><span class="c0">(</span><span class="c2 c3">maxLPSCenterPosition </span><span class="c0">-</span><span class="c2 c3">&nbsp;maxLPSLength</span><span class="c0">)/</span><span class="c8 c12 c3">2</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c3 c9">end</span><span class="c2 c3">&nbsp;</span><span class="c0">=</span><span class="c2 c3">&nbsp;start </span><span class="c0">+</span><span class="c2 c3">&nbsp;maxLPSLength </span><span class="c0">-</span><span class="c2 c3">&nbsp;</span><span class="c8 c12 c3">1</span><span class="c0">;</span><span class="c2 c3"><br> &nbsp; &nbsp;</span><span class="c8 c11 c3 c9">return</span><span class="c2 c3">&nbsp;make_pair</span><span class="c0">(</span><span class="c2 c3">start</span><span class="c0">,</span><span class="c2 c3">&nbsp;</span><span class="c8 c3 c9">end</span><span class="c0">);</span><span class="c2 c3"><br>}</span></p><p class="c4 c17"><span></span></p><p class="c4"><span class="c11">Suffix Array O(n) with some applications</span></p><p class="c4"><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;mask</span><span class="c1">[]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">{</span><span class="c2">&nbsp;</span><span class="c8 c12">0x80</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0x40</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0x20</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0x10</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0x08</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0x04</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0x02</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0x01</span><span class="c2">&nbsp;</span><span class="c1">};</span></p><p class="c4"><span class="c6">#define</span><span class="c2">&nbsp;tget</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">t</span><span class="c1">[(</span><span class="c2">i</span><span class="c1">)/</span><span class="c8 c12">8</span><span class="c1">]&amp;</span><span class="c2">mask</span><span class="c1">[(</span><span class="c2">i</span><span class="c1">)%</span><span class="c8 c12">8</span><span class="c1">])</span><span class="c2">&nbsp;</span><span class="c1">?</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c2">&nbsp;</span><span class="c1">:</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c2">&nbsp;)</span></p><p class="c4"><span class="c6">#define</span><span class="c2">&nbsp;tset</span><span class="c1">(</span><span class="c2">i</span><span class="c1">,</span><span class="c2">&nbsp;b</span><span class="c1">)</span><span class="c2">&nbsp;t</span><span class="c1">[(</span><span class="c2">i</span><span class="c1">)/</span><span class="c8 c12">8</span><span class="c1">]=(</span><span class="c2">b</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">?</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">mask</span><span class="c1">[(</span><span class="c2">i</span><span class="c1">)%</span><span class="c8 c12">8</span><span class="c1">]|</span><span class="c2">t</span><span class="c1">[(</span><span class="c2">i</span><span class="c1">)/</span><span class="c8 c12">8</span><span class="c1">])</span><span class="c2">&nbsp;</span><span class="c1">:</span><span class="c2">&nbsp;</span><span class="c1">((~</span><span class="c2">mask</span><span class="c1">[(</span><span class="c2">i</span><span class="c1">)%</span><span class="c8 c12">8</span><span class="c1">])&amp;</span><span class="c2">t</span><span class="c1">[(</span><span class="c2">i</span><span class="c1">)/</span><span class="c8 c12">8</span><span class="c1">])</span></p><p class="c4"><span class="c6">#define</span><span class="c2">&nbsp;chr</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">cs</span><span class="c1">==</span><span class="c8 c9">sizeof</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">)?((</span><span class="c8 c9">int</span><span class="c1">*)</span><span class="c2">s</span><span class="c1">)[</span><span class="c2">i</span><span class="c1">]:((</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*)</span><span class="c2">s</span><span class="c1">)[</span><span class="c2">i</span><span class="c1">])</span></p><p class="c4"><span class="c6">#define</span><span class="c2">&nbsp;isLMS</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i</span><span class="c1">&gt;</span><span class="c8 c12">0</span><span class="c2">&nbsp;</span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;tget</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;</span><span class="c1">!</span><span class="c2">tget</span><span class="c1">(</span><span class="c2">i</span><span class="c1">-</span><span class="c8 c12">1</span><span class="c1">))</span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4"><span class="c6">// find the start or end of each bucket</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;getBuckets</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">bkt</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">bool</span><span class="c2">&nbsp;</span><span class="c8 c9">end</span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">,</span><span class="c2">&nbsp;sum </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;=</span><span class="c2">&nbsp;K</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; bkt</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c6">// clear all buckets</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; bkt</span><span class="c1">[</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)]++;</span><span class="c2">&nbsp;</span><span class="c6">// compute the size of each bucket</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;=</span><span class="c2">&nbsp;K</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; sum </span><span class="c1">+=</span><span class="c2">&nbsp;bkt</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; bkt</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c9">end</span><span class="c2">&nbsp;</span><span class="c1">?</span><span class="c2">&nbsp;sum </span><span class="c1">:</span><span class="c2">&nbsp;sum </span><span class="c1">-</span><span class="c2">&nbsp;bkt</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4"><span class="c6">// compute SAl</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;induceSAl</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">t</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">SA</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">bkt</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">bool</span><span class="c2">&nbsp;</span><span class="c8 c9">end</span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">,</span><span class="c2">&nbsp;j;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; getBuckets</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">end</span><span class="c1">);</span><span class="c2">&nbsp;</span><span class="c6">// find starts of buckets</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; j </span><span class="c1">=</span><span class="c2">&nbsp;SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">j </span><span class="c1">&gt;=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c2">&nbsp;</span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;</span><span class="c1">!</span><span class="c2">tget</span><span class="c1">(</span><span class="c2">j</span><span class="c1">))</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">bkt</span><span class="c1">[</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">j</span><span class="c1">)]++]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;j;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4"><span class="c6">// compute SAs</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;induceSAs</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">t</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">SA</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">bkt</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">bool</span><span class="c2">&nbsp;</span><span class="c8 c9">end</span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">,</span><span class="c2">&nbsp;j;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; getBuckets</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">end</span><span class="c1">);</span><span class="c2">&nbsp;</span><span class="c6">// find ends of buckets</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;n </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&gt;=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">--)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; j </span><span class="c1">=</span><span class="c2">&nbsp;SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">j </span><span class="c1">&gt;=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c2">&nbsp;</span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;tget</span><span class="c1">(</span><span class="c2">j</span><span class="c1">))</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[--</span><span class="c2">bkt</span><span class="c1">[</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">j</span><span class="c1">)]]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;j;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4"><span class="c6">// find the suffix array SA of s[0..n-1] in {1..K}^n</span></p><p class="c4"><span class="c6">// require s[n-1]=0 (the sentinel!), n&gt;=2</span></p><p class="c4"><span class="c6">// use a working space (excluding s and SA) of at most 2.25n+O(1) for a constant alphabet</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;SA_IS</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">SA</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;cs</span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">,</span><span class="c2">&nbsp;j;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">t </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*)</span><span class="c2">&nbsp;malloc</span><span class="c1">(</span><span class="c2">n </span><span class="c1">/</span><span class="c2">&nbsp;</span><span class="c8 c12">8</span><span class="c2">&nbsp;</span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">);</span><span class="c2">&nbsp;</span><span class="c6">// LS-type array in bits</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// Classify the type of each character</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; tset</span><span class="c1">(</span><span class="c2">n</span><span class="c1">-</span><span class="c8 c12">2</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; tset</span><span class="c1">(</span><span class="c2">n</span><span class="c1">-</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">);</span><span class="c2">&nbsp;</span><span class="c6">// the sentinel must be in s1, important!!!</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;n </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">3</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&gt;=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">--)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; tset</span><span class="c1">(</span><span class="c2">i</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)&lt;</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">i</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">||</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)==</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">i</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;tget</span><span class="c1">(</span><span class="c2">i</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">)==</span><span class="c8 c12">1</span><span class="c1">))?</span><span class="c8 c12">1</span><span class="c1">:</span><span class="c8 c12">0</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// stage 1: reduce the problem by at least 1/2</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// sort all the S-substrings</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">bkt </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*)</span><span class="c2">&nbsp;malloc</span><span class="c1">(</span><span class="c8 c9">sizeof</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">K </span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">));</span><span class="c2">&nbsp;</span><span class="c6">// bucket array</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; getBuckets</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">true</span><span class="c1">);</span><span class="c2">&nbsp;</span><span class="c6">// find ends of buckets</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">isLMS</span><span class="c1">(</span><span class="c2">i</span><span class="c1">))</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[--</span><span class="c2">bkt</span><span class="c1">[</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">i</span><span class="c1">)]]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;i;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; induceSAl</span><span class="c1">(</span><span class="c2">t</span><span class="c1">,</span><span class="c2">&nbsp;SA</span><span class="c1">,</span><span class="c2">&nbsp;s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">false</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; induceSAs</span><span class="c1">(</span><span class="c2">t</span><span class="c1">,</span><span class="c2">&nbsp;SA</span><span class="c1">,</span><span class="c2">&nbsp;s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">true</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; free</span><span class="c1">(</span><span class="c2">bkt</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// compact all the sorted substrings into the first n1 items of SA</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// 2*n1 must be not larger than n (proveable)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;n1 </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">isLMS</span><span class="c1">(</span><span class="c2">SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]))</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">n1</span><span class="c1">++]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// find the lexicographic names of all substrings</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;n1</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c6">// init the name array buffer</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;name </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c2">&nbsp;prev </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n1</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;pos </span><span class="c1">=</span><span class="c2">&nbsp;SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">bool</span><span class="c2">&nbsp;diff </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c9">false;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;d </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;d </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;d</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">prev </span><span class="c1">==</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c8 c12">1</span><span class="c2">&nbsp;</span><span class="c1">||</span><span class="c2">&nbsp;chr</span><span class="c1">(</span><span class="c2">pos</span><span class="c1">+</span><span class="c2">d</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">!=</span><span class="c2">&nbsp;chr</span><span class="c1">(</span><span class="c2">prev</span><span class="c1">+</span><span class="c2">d</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">||</span><span class="c2">&nbsp;tget</span><span class="c1">(</span><span class="c2">pos</span><span class="c1">+</span><span class="c2">d</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">!=</span><span class="c2">&nbsp;tget</span><span class="c1">(</span><span class="c2">prev</span><span class="c1">+</span><span class="c2">d</span><span class="c1">))</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; diff </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c9">true;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">break;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c1">}</span><span class="c2">&nbsp;</span><span class="c8 c9">else</span><span class="c2">&nbsp;</span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">d </span><span class="c1">&gt;</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c2">&nbsp;</span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">isLMS</span><span class="c1">(</span><span class="c2">pos</span><span class="c1">+</span><span class="c2">d</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">||</span><span class="c2">&nbsp;isLMS</span><span class="c1">(</span><span class="c2">prev</span><span class="c1">+</span><span class="c2">d</span><span class="c1">)))</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">break;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">diff</span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name</span><span class="c1">++;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev </span><span class="c1">=</span><span class="c2">&nbsp;pos;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; pos </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">pos </span><span class="c1">%</span><span class="c2">&nbsp;</span><span class="c8 c12">2</span><span class="c2">&nbsp;</span><span class="c1">==</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">?</span><span class="c2">&nbsp;pos </span><span class="c1">/</span><span class="c2">&nbsp;</span><span class="c8 c12">2</span><span class="c2">&nbsp;</span><span class="c1">:</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">pos </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">/</span><span class="c2">&nbsp;</span><span class="c8 c12">2;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">n1 </span><span class="c1">+</span><span class="c2">&nbsp;pos</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;name </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;n </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;j </span><span class="c1">=</span><span class="c2">&nbsp;n </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&gt;=</span><span class="c2">&nbsp;n1</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">--)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">&gt;=</span><span class="c2">&nbsp;</span><span class="c8 c12">0)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">j</span><span class="c1">--]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// stage 2: solve the reduced problem</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// recurse if names are not yet unique</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">SA1 </span><span class="c1">=</span><span class="c2">&nbsp;SA</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">s1 </span><span class="c1">=</span><span class="c2">&nbsp;SA </span><span class="c1">+</span><span class="c2">&nbsp;n </span><span class="c1">-</span><span class="c2">&nbsp;n1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">name </span><span class="c1">&lt;</span><span class="c2">&nbsp;n1)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA_IS</span><span class="c1">((</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c1">*)</span><span class="c2">&nbsp;s1</span><span class="c1">,</span><span class="c2">&nbsp;SA1</span><span class="c1">,</span><span class="c2">&nbsp;n1</span><span class="c1">,</span><span class="c2">&nbsp;name </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">sizeof</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">));</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">else</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c6">// generate the suffix array of s1 directly</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n1</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SA1</span><span class="c1">[</span><span class="c2">s1</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;i;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// stage 3: induce the result for the original problem</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; bkt </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*)</span><span class="c2">&nbsp;malloc</span><span class="c1">(</span><span class="c8 c9">sizeof</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">K </span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">));</span><span class="c2">&nbsp;</span><span class="c6">// bucket array</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">// put all left-most S characters into their buckets</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; getBuckets</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">true</span><span class="c1">);</span><span class="c2">&nbsp;</span><span class="c6">// find ends of buckets</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;j </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">isLMS</span><span class="c1">(</span><span class="c2">i</span><span class="c1">))</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s1</span><span class="c1">[</span><span class="c2">j</span><span class="c1">++]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;i</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c6">// get p1</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n1</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA1</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;s1</span><span class="c1">[</span><span class="c2">SA1</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]];</span><span class="c2">&nbsp;</span><span class="c6">// get index in s</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;n1</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;</span><span class="c6">// init SA[n1..n-1]</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">i </span><span class="c1">=</span><span class="c2">&nbsp;n1 </span><span class="c1">-</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&gt;=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">--)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; j </span><span class="c1">=</span><span class="c2">&nbsp;SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">-</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; SA</span><span class="c1">[--</span><span class="c2">bkt</span><span class="c1">[</span><span class="c2">chr</span><span class="c1">(</span><span class="c2">j</span><span class="c1">)]]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;j;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; induceSAl</span><span class="c1">(</span><span class="c2">t</span><span class="c1">,</span><span class="c2">&nbsp;SA</span><span class="c1">,</span><span class="c2">&nbsp;s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">false</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; induceSAs</span><span class="c1">(</span><span class="c2">t</span><span class="c1">,</span><span class="c2">&nbsp;SA</span><span class="c1">,</span><span class="c2">&nbsp;s</span><span class="c1">,</span><span class="c2">&nbsp;bkt</span><span class="c1">,</span><span class="c2">&nbsp;n</span><span class="c1">,</span><span class="c2">&nbsp;K</span><span class="c1">,</span><span class="c2">&nbsp;cs</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">true</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; free</span><span class="c1">(</span><span class="c2">bkt</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; free</span><span class="c1">(</span><span class="c2">t</span><span class="c1">);</span></p><p class="c4"><span class="c2">}</span></p><p class="c4"><span class="c8 c9">const</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;maxn </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">1000100;</span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;sa</span><span class="c1">[</span><span class="c2">maxn</span><span class="c1">];</span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;lcp</span><span class="c1">[</span><span class="c2">maxn</span><span class="c1">];</span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;pos</span><span class="c1">[</span><span class="c2">maxn</span><span class="c1">];</span></p><p class="c4"><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">s;</span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;n;</span></p><p class="c4"><span class="c8 c9">void</span><span class="c2">&nbsp;calc_lcp</span><span class="c1">()</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; pos</span><span class="c1">[</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;i;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c2">&nbsp;h </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">&nbsp;i </span><span class="c1">&lt;</span><span class="c2">&nbsp;n</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">&nbsp;i</span><span class="c1">++)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">pos</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">&lt;</span><span class="c2">&nbsp;n </span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;j </span><span class="c1">=</span><span class="c2">&nbsp;sa</span><span class="c1">[</span><span class="c2">pos</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">];</span><span class="c2">&nbsp;s</span><span class="c1">[</span><span class="c2">i </span><span class="c1">+</span><span class="c2">&nbsp;h</span><span class="c1">]</span><span class="c2">&nbsp;</span><span class="c1">==</span><span class="c2">&nbsp;s</span><span class="c1">[</span><span class="c2">j </span><span class="c1">+</span><span class="c2">&nbsp;h</span><span class="c1">];</span><span class="c2">&nbsp;</span><span class="c1">++</span><span class="c2">h)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcp</span><span class="c1">[</span><span class="c2">pos</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]]</span><span class="c2">&nbsp;</span><span class="c1">=</span><span class="c2">&nbsp;h;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">h </span><span class="c1">&gt;</span><span class="c2">&nbsp;</span><span class="c8 c12">0)</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c1">--</span><span class="c2">h;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4"><span class="c6">/*</span></p><p class="c4"><span class="c2">&nbsp;str</span><span class="c1">=</span><span class="c8 c19">&quot;abcab&quot;</span><span class="c2">&nbsp;n</span><span class="c1">=5</span></p><p class="c4"><span class="c2">&nbsp;SA_IS</span><span class="c1">(</span><span class="c2">str</span><span class="c1">,</span><span class="c2">sa</span><span class="c1">,</span><span class="c2">n</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c8 c12">256</span><span class="c1">,</span><span class="c8 c12">1)</span></p><p class="c4"><span class="c2">&nbsp;calc_lcp</span><span class="c1">()</span></p><p class="c4"><span class="c2">&nbsp;sa</span><span class="c1">={</span><span class="c8 c12">5</span><span class="c1">,</span><span class="c8 c12">3</span><span class="c1">,</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c8 c12">4</span><span class="c1">,</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c8 c12">2}</span></p><p class="c4"><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">subtring</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">)={</span><span class="c8 c19">&quot;&quot;</span><span class="c1">,</span><span class="c8 c19">&quot;ab&quot;</span><span class="c1">,</span><span class="c8 c19">&quot;abcab&quot;</span><span class="c1">,</span><span class="c8 c19">&quot;b&quot;</span><span class="c1">,</span><span class="c8 c19">&quot;bcab&quot;</span><span class="c1">,</span><span class="c8 c19">&quot;cab&quot;}</span></p><p class="c4"><span class="c2">&nbsp;lcp</span><span class="c1">={</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c8 c12">2</span><span class="c1">,</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c8 c12">0}</span></p><p class="c4"><span class="c2">&nbsp;pos</span><span class="c1">={</span><span class="c8 c12">2</span><span class="c1">,</span><span class="c8 c12">4</span><span class="c1">,</span><span class="c8 c12">5</span><span class="c1">,</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c8 c12">3</span><span class="c1">,</span><span class="c8 c12">0}</span></p><p class="c4"><span class="c2">&nbsp;</span><span class="c1">*/</span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4"><span class="c2">pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c1">&gt;</span><span class="c2">&nbsp;longest_repeated_substring</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;overlap</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">//overlap=1 non-overlapping , overlap=0 overlap allowed</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;maxl</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c2">maxidx</span><span class="c1">=-</span><span class="c8 c12">1;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">=</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">i</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">i</span><span class="c1">++){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">lcp</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]&gt;</span><span class="c2">maxl</span><span class="c1">)</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">overlap </span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;abs</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]-</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">-</span><span class="c8 c12">1</span><span class="c1">])&lt;</span><span class="c2">lcp</span><span class="c1">[</span><span class="c2">i</span><span class="c1">])</span><span class="c2">&nbsp;</span><span class="c8 c9">continue;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; maxl</span><span class="c1">=</span><span class="c2">lcp</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; maxidx</span><span class="c1">=</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">maxidx</span><span class="c1">==-</span><span class="c8 c12">1</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c8 c9">return</span><span class="c2">&nbsp;make_pair</span><span class="c1">(-</span><span class="c8 c12">1</span><span class="c1">,-</span><span class="c8 c12">1</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;make_pair</span><span class="c1">(</span><span class="c2">maxidx</span><span class="c1">,</span><span class="c2">maxl</span><span class="c1">);</span></p><p class="c4"><span class="c2">}</span></p><p class="c4"><span class="c8">vector&lt;pair&lt;pair&lt;int,int&gt;,int&gt;&gt; poss_krs; // holds all possible longest_k_rep_substr , take union with return value.</span></p><p class="c4"><span class="c8">pair&lt;pair&lt;int,int&gt;,int&gt; longest_k_repeated_substring(string str,int k){</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; k--;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; for (int i = 0; i &lt; n+1; i++)</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; pos[sa[i]] = i;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; int maxl=0,maxidx=-1,rightmostidx=0;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; for (int i = 0, h = 0; i &lt; n+1; i++) {</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; if (pos[i] &lt; n +1-k) {</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int j = sa[pos[i] + k]; s[i + h] == s[j + h]; ++h)</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(h==maxl){</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; poss_krs.push_back(make_pair(make_pair(rightmostidx,maxidx),maxl));</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(h&gt;maxl) rightmostidx=sa[pos[i] + k];</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; maxl=h;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; maxidx=i;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(rightmostidx&lt;sa[pos[i] + k]) rightmostidx=sa[pos[i] + k];</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(h&gt;maxl){</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; poss_krs.clear();</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(h&gt;maxl) rightmostidx=sa[pos[i] + k];</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; maxl=h;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; maxidx=i;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(rightmostidx&lt;sa[pos[i] + k]) rightmostidx=sa[pos[i] + k];</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //cout&lt;&lt;i&lt;&lt;&quot; &quot;&lt;&lt;h&lt;&lt;&quot; &quot;&lt;&lt;str.substr(i,h)&lt;&lt;maxl&lt;&lt;&quot; &quot;&lt;&lt;str.substr(maxidx,maxl)&lt;&lt;&quot; &quot;&lt;&lt;rightmostidx&lt;&lt;endl;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (h &gt; 0)</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --h;</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; if(maxidx==-1) return make_pair(make_pair(-1,-1),-1);</span></p><p class="c4"><span class="c8">&nbsp; &nbsp; return make_pair(make_pair(rightmostidx,maxidx),maxl);</span></p><p class="c4"><span class="c8">}</span></p><p class="c4 c17"><span class="c8"></span></p><p class="c4"><span class="c2">pair</span><span class="c1">&lt;</span><span class="c2">pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c1">&gt;,</span><span class="c2">pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c1">&gt;</span><span class="c2">&nbsp;</span><span class="c1">&gt;</span><span class="c2">&nbsp;longest_common_substring</span><span class="c1">(</span><span class="c8 c9">string</span><span class="c2">&nbsp;str1</span><span class="c1">,</span><span class="c8 c9">string</span><span class="c2">&nbsp;str2</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">string</span><span class="c2">&nbsp;str</span><span class="c1">=</span><span class="c2">str1</span><span class="c1">+</span><span class="c8 c19">&quot; &quot;</span><span class="c1">+</span><span class="c2">str2;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; s </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c1">*)</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">c_str</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; n </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">)</span><span class="c2">str</span><span class="c1">.</span><span class="c2">size</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; SA_IS</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;sa</span><span class="c1">,</span><span class="c2">&nbsp;n </span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">256</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; calc_lcp</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c1">&gt;</span><span class="c2">&nbsp;p</span><span class="c1">=</span><span class="c2">longest_repeated_substring</span><span class="c1">(</span><span class="c8 c12">0</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;indx2</span><span class="c1">=</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">pos</span><span class="c1">[</span><span class="c2">p</span><span class="c1">.</span><span class="c2">first</span><span class="c1">]+</span><span class="c8 c12">1</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c6">//cout&lt;&lt;str.substr(p.first,p.second)&lt;&lt;&quot; &quot;&lt;&lt;str.substr(indx2,p.second)&lt;&lt;endl;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">((</span><span class="c2">p</span><span class="c1">.</span><span class="c2">first</span><span class="c1">&lt;</span><span class="c2">str1</span><span class="c1">.</span><span class="c2">length</span><span class="c1">()&amp;&amp;</span><span class="c2">indx2</span><span class="c1">&lt;</span><span class="c2">str1</span><span class="c1">.</span><span class="c2">length</span><span class="c1">())||(</span><span class="c2">p</span><span class="c1">.</span><span class="c2">first</span><span class="c1">&gt;</span><span class="c2">str1</span><span class="c1">.</span><span class="c2">length</span><span class="c1">()&amp;&amp;</span><span class="c2">indx2</span><span class="c1">&gt;</span><span class="c2">str1</span><span class="c1">.</span><span class="c2">length</span><span class="c1">())</span><span class="c2">&nbsp;</span><span class="c1">||</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">substr</span><span class="c1">(</span><span class="c2">p</span><span class="c1">.</span><span class="c2">first</span><span class="c1">,</span><span class="c2">p</span><span class="c1">.</span><span class="c2">second</span><span class="c1">)!=</span><span class="c2">str</span><span class="c1">.</span><span class="c2">substr</span><span class="c1">(</span><span class="c2">indx2</span><span class="c1">,</span><span class="c2">p</span><span class="c1">.</span><span class="c2">second</span><span class="c1">))</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;make_pair</span><span class="c1">(</span><span class="c2">make_pair</span><span class="c1">(</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c8 c12">0</span><span class="c1">),</span><span class="c2">p</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;make_pair</span><span class="c1">(</span><span class="c2">p</span><span class="c1">,</span><span class="c2">make_pair</span><span class="c1">(</span><span class="c2">indx2</span><span class="c1">,</span><span class="c2">p</span><span class="c1">.</span><span class="c2">second</span><span class="c1">));</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4"><span class="c2">pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c1">&gt;</span><span class="c2">&nbsp;smallest_lex_rotation</span><span class="c1">(</span><span class="c8 c9">string</span><span class="c2">&nbsp;str</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span></p><p class="c4"><span class="c2">&nbsp; &nbsp; str</span><span class="c1">=</span><span class="c2">str</span><span class="c1">+</span><span class="c2">str;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; s </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c1">*)</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">c_str</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span></p><p class="c4"><span class="c2">&nbsp; &nbsp; n </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">)</span><span class="c2">str</span><span class="c1">.</span><span class="c2">size</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; SA_IS</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;sa</span><span class="c1">,</span><span class="c2">&nbsp;n </span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">256</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">=</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">i</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">i</span><span class="c1">++){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c6">//cout&lt;&lt;str.substr(sa[i])&lt;&lt;&quot; &quot;&lt;&lt;sa[i]&lt;&lt;&quot;\n&quot;;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;minval</span><span class="c1">=</span><span class="c2">maxn;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">=</span><span class="c8 c12">0</span><span class="c1">;</span><span class="c2">i</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">i</span><span class="c1">++){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]&lt;=</span><span class="c2">n</span><span class="c1">/</span><span class="c8 c12">2</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">while</span><span class="c1">(</span><span class="c2">i</span><span class="c1">&lt;</span><span class="c2">n </span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]&lt;=</span><span class="c2">n</span><span class="c1">/</span><span class="c8 c12">2</span><span class="c2">&nbsp;</span><span class="c1">&amp;&amp;</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">substr</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">],</span><span class="c2">n</span><span class="c1">/</span><span class="c8 c12">2</span><span class="c1">)==</span><span class="c2">str</span><span class="c1">.</span><span class="c2">substr</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">],</span><span class="c2">n</span><span class="c1">/</span><span class="c8 c12">2</span><span class="c1">)){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c1">(</span><span class="c2">minval</span><span class="c1">&gt;</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">])</span><span class="c2">&nbsp;minval</span><span class="c1">=</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c6">//printf(&quot;i %d\n&quot;,i);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i</span><span class="c1">++;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;make_pair</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">],</span><span class="c2">n</span><span class="c1">/</span><span class="c8 c12">2</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;make_pair</span><span class="c1">(-</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">n</span><span class="c1">/</span><span class="c8 c12">2</span><span class="c1">);</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c20"></span></p><p class="c4"><span class="c8 c9">long</span><span class="c2">&nbsp;count_distinct_substrings</span><span class="c1">(</span><span class="c8 c9">string</span><span class="c2">&nbsp;str</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; s </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c1">*)</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">c_str</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; n </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">)</span><span class="c2">str</span><span class="c1">.</span><span class="c2">size</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; SA_IS</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;sa</span><span class="c1">,</span><span class="c2">&nbsp;n </span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">256</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; calc_lcp</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">long</span><span class="c2">&nbsp;count</span><span class="c1">=</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">for</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c2">&nbsp;i</span><span class="c1">=</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">i</span><span class="c1">&lt;</span><span class="c2">n</span><span class="c1">+</span><span class="c8 c12">1</span><span class="c1">;</span><span class="c2">i</span><span class="c1">++)</span><span class="c2">&nbsp;count</span><span class="c1">+=</span><span class="c2">n</span><span class="c1">-</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">i</span><span class="c1">]-</span><span class="c2">lcp</span><span class="c1">[</span><span class="c2">i</span><span class="c1">];</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;count;</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4"><span class="c2">pair</span><span class="c1">&lt;</span><span class="c8 c9">int</span><span class="c1">,</span><span class="c8 c9">int</span><span class="c1">&gt;</span><span class="c2">&nbsp;longest_palindromic_substring</span><span class="c1">(</span><span class="c8 c9">string</span><span class="c2">&nbsp;str</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">string</span><span class="c2">&nbsp;revstr</span><span class="c1">=</span><span class="c8 c9">string</span><span class="c1">(</span><span class="c2">str</span><span class="c1">.</span><span class="c2">rbegin</span><span class="c1">(),</span><span class="c2">str</span><span class="c1">.</span><span class="c2">rend</span><span class="c1">());</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;longest_common_substring</span><span class="c1">(</span><span class="c2">str</span><span class="c1">,</span><span class="c2">&nbsp;revstr</span><span class="c1">).</span><span class="c2">first;</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4"><span class="c8 c9">bool</span><span class="c2">&nbsp;contain</span><span class="c1">(</span><span class="c8 c9">string</span><span class="c2">&nbsp;str</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">int</span><span class="c2">&nbsp;</span><span class="c1">*</span><span class="c2">sa</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c9">string</span><span class="c2">&nbsp;T</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;a </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c1">,</span><span class="c2">&nbsp;b </span><span class="c1">=</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">length</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">while</span><span class="c1">(</span><span class="c2">&nbsp;b </span><span class="c1">-</span><span class="c2">&nbsp;a </span><span class="c1">&gt;</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c2">&nbsp;</span><span class="c1">){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;c </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">a </span><span class="c1">+</span><span class="c2">&nbsp;b </span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">/</span><span class="c2">&nbsp;</span><span class="c8 c12">2;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">if</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">compare</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">c</span><span class="c1">],</span><span class="c2">&nbsp;T</span><span class="c1">.</span><span class="c2">length</span><span class="c1">(),</span><span class="c2">&nbsp;T</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">&lt;</span><span class="c2">&nbsp;</span><span class="c8 c12">0</span><span class="c2">&nbsp;</span><span class="c1">)</span><span class="c2">&nbsp;a </span><span class="c1">=</span><span class="c2">&nbsp;c;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">else</span><span class="c2">&nbsp;b </span><span class="c1">=</span><span class="c2">&nbsp;c;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">return</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">compare</span><span class="c1">(</span><span class="c2">sa</span><span class="c1">[</span><span class="c2">b</span><span class="c1">],</span><span class="c2">&nbsp;T</span><span class="c1">.</span><span class="c2">length</span><span class="c1">(),</span><span class="c2">&nbsp;T</span><span class="c1">)</span><span class="c2">&nbsp;</span><span class="c1">==</span><span class="c2">&nbsp;</span><span class="c8 c12">0;</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4 c17"><span class="c2"></span></p><p class="c4"><span class="c8 c9">int</span><span class="c2">&nbsp;main</span><span class="c1">()</span><span class="c2">&nbsp;{</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">string</span><span class="c2">&nbsp;str;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; cin</span><span class="c1">&gt;&gt;</span><span class="c2">str;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; s </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">unsigned</span><span class="c2">&nbsp;</span><span class="c8 c9">char</span><span class="c1">*)</span><span class="c2">&nbsp;str</span><span class="c1">.</span><span class="c2">c_str</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; n </span><span class="c1">=</span><span class="c2">&nbsp;</span><span class="c1">(</span><span class="c8 c9">int</span><span class="c1">)</span><span class="c2">str</span><span class="c1">.</span><span class="c2">size</span><span class="c1">();</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; SA_IS</span><span class="c1">(</span><span class="c2">s</span><span class="c1">,</span><span class="c2">&nbsp;sa</span><span class="c1">,</span><span class="c2">&nbsp;n </span><span class="c1">+</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">256</span><span class="c1">,</span><span class="c2">&nbsp;</span><span class="c8 c12">1</span><span class="c1">);</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">int</span><span class="c2">&nbsp;t;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; cin</span><span class="c1">&gt;&gt;</span><span class="c2">t;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; </span><span class="c8 c9">while</span><span class="c1">(</span><span class="c2">t</span><span class="c1">--){</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c8 c9">string</span><span class="c2">&nbsp;pat;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; cin</span><span class="c1">&gt;&gt;</span><span class="c2">pat;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; cout</span><span class="c1">&lt;&lt;</span><span class="c2">contain</span><span class="c1">(</span><span class="c2">str</span><span class="c1">,</span><span class="c2">sa</span><span class="c1">,</span><span class="c2">pat</span><span class="c1">)&lt;&lt;</span><span class="c8 c19">&quot;\n&quot;;</span></p><p class="c4"><span class="c2">&nbsp; &nbsp; }</span></p><p class="c4"><span class="c2">}</span></p><p class="c4 c17"><span></span></p><p class="c4 c17"><span></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c17 c34"><span class="c18"></span></p><p class="c4 c24 c17"><span class="c18"></span></p><p class="c4 c24"><span class="c18">Team Overflow</span></p><div><p class="c4 c28"><span>Vignesh Manoharan</span></p><p class="c4 c28"><span>Sachin Sridhar</span></p><p class="c4 c28"><span>Adhityaa Chandrasekar</span></p></div></body></html>